{"version":3,"sources":["redux/actions.ts","redux/selectors.ts","styled/mixins/layout.ts","data/tagUtils.ts","icons/FontAwesomeIcons.tsx","data/types.ts","components/designsystem/Buttons.tsx","styled/mixins/theming.ts","styled/mixins/gap.ts","firebase/signIn.ts","firebase/storage.ts","firebase/genericConverter.ts","firebase/analytics.ts","firebase/index.ts","components/designsystem/Text.tsx","styled/zIndex.ts","data/browserUtils.ts","data/utils.ts","hooks/useAction.tsx","hooks/usePreference.tsx","components/designsystem/Surface.tsx","misc/formatting.ts","components/designsystem/FlexPair.tsx","components/designsystem/FlexImage.tsx","hooks/useOnlineChange.ts","components/designsystem/LabeledToggle.tsx","icons/TypeIcon.tsx","styled/mixins/scrollbar.ts","components/designsystem/FlexColumn.tsx","styled/mixins/media.ts","components/designsystem/Toggle.tsx","hooks/useFirebaseAuthState.tsx","components/widgets/OfflineIndicator.tsx","components/widgets/Menubar.tsx","components/features/Header.tsx","components/designsystem/ModifierStyledText.tsx","components/tag/TagName.tsx","components/tag/Alias.tsx","components/tag/AliasesList.tsx","components/tag/ChipWrapper.tsx","components/tag/TagChip.tsx","components/tag/Supertag.tsx","components/tag/BiasedTag.tsx","components/tag/Tag.tsx","components/tag/TagList.tsx","styled/mixins/shadow.ts","components/designsystem/Lines.tsx","hooks/useToggle.ts","data/encryption.ts","hooks/useToggleTag.tsx","components/tagSelector/DropdownListEntry.tsx","components/tagSelector/DropdownListError.tsx","components/tagSelector/DropdownList.tsx","components/tagSelector/TagInput.tsx","components/tagSelector/TagSelector.tsx","components/widgets/ResetButton.tsx","icons/OutOfResults.png","icons/Loading.tsx","icons/R34Icon.tsx","hooks/useModifier.tsx","components/widgets/ActiveTags.tsx","hooks/useCheckIsActive.ts","hooks/useActivateTag.ts","components/features/ErrorBoundary.tsx","components/features/GlobalKeybindings.tsx","GlobalStyles.tsx","components/pages/ErrorScreen.tsx","components/pages/LoadingScreen.tsx","components/pages/Terms.tsx","components/designsystem/Modal.tsx","icons/eeek.png","components/widgets/CellularWarningModal.tsx","components/widgets/CookieConfirmation.tsx","components/widgets/SupertagModal.tsx","analytics/events.ts","redux/middleware/analytics.ts","redux/reducers/preferences.ts","redux/middleware/persistence.ts","misc/api.ts","redux/middleware/requests.ts","redux/middleware/index.ts","redux/migrations.ts","redux/reducers/results.ts","redux/reducers/tags.ts","redux/reducers/fullscreen.ts","redux/reducers/likes.ts","redux/reducers/modals.ts","redux/reducers/suggestions.ts","redux/reducers/index.ts","redux/store.ts","App.tsx","hooks/useLoadPreferences.tsx","serviceWorkerRegistration.ts","index.tsx"],"names":["ADD_ALIASES","ADD_POSTS","ADD_TAG","CLOSE_MODAL","ENTER_FULLSCREEN","EXIT_FULLSCREEN","FETCH_COMMENTS","FETCH_PREFERENCES","FETCH_SUGGESTIONS","GET_MORE_RESULTS","GET_RESULTS","LIKE_POST","OPEN_MODAL","REMOVE_TAG","SAVE_PREFERENCES","SET_COMMENTS","SET_FULLSCREEN_POST","SET_POSTS","SET_PREFERENCE","SET_PREFERENCES","SET_SUGGESTIONS","SET_SUGGESTIONS_ERROR","SET_SUGGESTIONS_MODIFIER","SCROLL_TO_POST","addTag","tag","type","removeTag","tagName","addAliases","aliases","forTag","addPosts","posts","setPosts","count","pageNumber","setComments","postId","comments","fetchComments","setPreference","key","value","setPreferences","preferences","getResults","getMoreResults","setFullscreenPost","index","scrollToPost","likePost","openModal","modalId","closeModal","setSuggestions","suggestions","setSuggestionsError","error","fetchSuggestions","includeSupertags","fetchPreferences","savePreferences","setSuggestionsModifier","modifier","selectActiveTags","state","tags","active","selectActiveThemeId","themeId","selectAliases","selectAutoPlay","autoPlay","selectCookies","cookies","selectCount","results","selectFullsceenIndex","fullscreen","currentIndex","selectHideSeen","hideSeen","selectOpenModalId","modals","selectOriginals","originals","selectPageNumber","selectPageSize","pageSize","selectPosts","selectPreferences","selectPreloadVideos","preloadVideos","selectPreloadGifs","selectResultsLayout","resultsLayout","selectShowComments","showComments","selectShowMetadata","showMetadata","selectSort","sort","selectSuggestions","entries","selectSuggestionsError","selectSuggestionsModifier","selectTagSuggestionCount","tagSuggestionsCount","selectUpdated","updated","selectAutoscrollDelay","autoscrollDelay","selectNumberOfActiveTags","createSelector","Object","keys","length","selectAliasesAsList","values","flat","selectOutOfResults","selectHasMoreResults","outOfResults","selectLastPage","Math","ceil","selectFullScreenPost","fullScreenIndex","selectFullScreenIndex","fullScreenPost","indexOf","selectMinRating","rated","ratedThreshold","selectSupertagModalOpen","selectedIndex","undefined","ModalId","CREATE_SUPERTAG","selectCellularWarningModalOpen","CELLULAR_WARNING","selectPostById","defaultMemoize","id","find","post","selectPostByIndex","selectLikedByPostId","likes","selectActiveSupertagTags","activeTags","filter","isSupertag","reduce","result","multilineList","theme","css","flexRowGap","dimensions","bigSpacing","flexColumnGap","flexColumn","flexColumnWithGap","gridWithGap","gap","flexRowWithGap","centeredMaxWidth","bodyWidth","defaultBlock","blockHeight","fullscreenOverlay","coverScreen","buttonBaseStyle","borderRadius","fontSizes","content","defaultRowSpacing","transitionAll","serializeAllTags","resolvedTags","forEach","name","push","flattenSupertags","tagsByModifier","current","groupTagsByModifier","normalTags","map","serializeTag","join","optionalTags","serializeTagname","tagname","encodeURIComponent","toLowerCase","replace","getTagParameter","minScore","tagParts","bias","isBiased","getInterestingType","types","t","match","isSuggestionError","message","encodeSupertag","supertag","payload","encodeURI","description","m","Buffer","from","toString","decodeSupertag","base64","parts","substr","split","decodeURI","fromEntries","e","bindIcon","icon","React","memo","props","ArrowDown","faCaretDown","ArtistIcon","faPen","CalendarIcon","faCalendarDay","CharacterIcon","faUser","CheckIcon","faCheckSquare","CloseIcon","faTimes","CodeBranchIcon","faCodeBranch","CopyIcon","faCopy","CopyrightIcon","faCopyright","DeviantArtIcon","faDeviantart","DiscordIcon","faDiscord","DownloadIcon","faDownload","ExpandIcon","faExpand","ExternalLinkIcon","faExternalLinkAlt","FailedIcon","faTimesCircle","GithubIcon","faGithub","GoogleIcon","faGoogle","HeartIcon","faHeart","ImageIcon","faImage","LinkIcon","faLink","MetaDataIcon","faInfoCircle","PatreonIcon","faPatreon","PlusIcon","faPlus","PrivacyIcon","faUserShield","RatingIcon","faRegistered","SearchIcon","faSearch","ShareIcon","faCog","faShareAlt","SignOutIcon","faSignOutAlt","SourceIcon","faHashtag","SuccessIcon","faCheckCircle","SupertagIcon","faTags","TermsIcon","faScroll","TumblrIcon","faTumblr","TwitterIcon","faTwitter","UndoIcon","faUndoAlt","WrenchIcon","faWrench","ForwardIcon","faForward","BackwardIcon","faBackward","SubmitIcon","faArrowRight","ArrowUp","faArrowUp","RouteName","NO_OP","TextButton","styled","button","LinkButton","a","hugeSpacing","colors","layerBg","text","InvisButton","dropShadow","PrimaryButton","primary","BlockButton","AddButton","ModifierButton","defaultBorder","timings","transitionTime","accentColor","borderWidth","disabled","backgroundColor","subduedText","pointerInteraction","secondary","foreground","focus","backgroundColor2","layer","solidLayer","layerBgSolid","defaultInput","amount","supportsGap","supportsFlexGap","defaultSpacing","googleAuthProvider","initialized","signIn","firebase","auth","signInWithPopup","catch","console","code","warn","signOut","userConverter","GenericConverter","data","snapshot","options","getUserDoc","currentUser","email","sha256","userDoc","firestore","collection","doc","getUserData","withConverter","get","userSnap","userData","getPreferences","set","resetSeenPosts","getSupertags","snap","addSupertag","removeSupertag","delete","setTagsOfSupertag","update","logEvent","event","analytics","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","init","initializeApp","GoogleAuthProvider","window","navigator","onLine","addEventListener","once","Title","h2","bigTitle","BigTitle","h1","SmallTitle","h3","Faded","span","ZIndex","flex","document","createElement","style","display","flexDirection","rowGap","appendChild","body","isSupported","scrollHeight","parentNode","removeChild","supportsAspectRatio","supportsObjectFit","supportsFullscreen","fullscreenEnabled","supportsNetworkInformationAPI","supportsLocalStorage","Boolean","localStorage","openFullscreen","element","fullscreenElement","requestFullscreen","Promise","resolve","listToMap","list","keyProp","parseUrl","URL","err","versionToNumber","majorMinorPatch","Number","download","url","filename","pop","fetch","headers","Headers","Origin","location","origin","mode","then","response","blob","href","createObjectURL","click","remove","getVersion","process","REACT_APP_VERSION","getVersionString","version","boolToNumber","randomBelow","max","floor","random","useAction","actionCreator","dispatch","useDispatch","useCallback","usePreference","useSelector","setValue","Surface","div","SolidSurface","formatCount","trunc","formatSource","source","host","formatDuration","duration","min","sec","formatTagname","formatTagnameAndCount","z","formatDatetime","date","dd","getDate","MM","getMonth","yyyy","getFullYear","hh","getHours","mm","getMinutes","formatTime","milliseconds","formatUnit","unitSize","unit","toFixed","unitString","FlexPair","FlexImage","img","flexMedia","preserveAspectRatio","useOnlineChange","useState","isOnline","setIsOnline","useEffect","listenter","onOnline","removeEventListener","onOffline","LabeledToggle","children","onToggle","className","TypeIcon","dropdownScrollbar","FlexColumn","FlexColumnWithSpacing","mediaStyle","width","height","Track","longTransitionTime","Thumb","toggleOff","Toggle","onClick","role","useFirebaseAuthState","authState","setAuthState","user","setUser","unsubscribe","onAuthStateChanged","OfflineIndicator","useTheme","title","color","negative","MenuBar","nav","LocationStyledLink","Link","to","Menu","useLocation","pathname","SEARCH","PREFERENCES","ABOUT","HeaderWrapper","header","TitleBar","Header","R34Icon","size","modifierToStyle","ModifierStyledText","TagName","AliasWrapper","Alias","handleClick","stopPropagation","ListWrapper","parentRef","clientRect","getBoundingClientRect","offsetTop","offsetLeft","DROPDOWN","AliasesList","ChipWrapper","collapsed","switchingColors","DropdownArrow","$collapsed","DropdownWrapper","TagChip","isActive","detailed","onContextMenu","tagRef","setTagRef","useToggle","toggleCollapsed","preventDefault","handleArrowClick","handleEnter","handleContextMenu","onKeyDown","ref","tabIndex","Supertag","BiasedTag","Tag","biasedTag","TagListWrapper","TagList","onTagClick","getIsActive","onTagMenu","shadow","radius","HorizontalLine","layerBgHighlight","initialValue","toggleValue","resetValue","msgBuffer","TextEncoder","encode","crypto","subtle","digest","hashBuffer","hashArray","Array","Uint8Array","hashHex","b","padStart","useToggleTag","EntryWrapper","Name","Count","Icon","DropdownListEntry","DropdownListError","tagSelectorRef","tagSelector","clientHeight","clientWidth","sizeAndPosition","DropdownList","entry","Input","input","TagInput","onSubmit","handleChange","target","onChange","placeholder","TagSelectorWrapper","form","closed","TagSelector","showSupertags","setTagSelectorRef","useModifier","nextModifier","activateTag","useThrottledEffect","handleAddClick","trim","sanitizedTagname","suggestion","s","showList","ResetButton","reset","clear","hash","reload","StyledSvg","svg","Loading","xmlns","xmlnsXlink","viewBox","xmlSpace","fill","stroke","cx","cy","r","attributeName","dur","repeatCount","begin","transform","strokeWidth","strokeMiterlimit","strokeDasharray","strokeOpacity","fontStyle","fontWeight","fontSize","fontFamily","letterSpacing","wordSpacing","fillOpacity","x","y","fontVariant","fontStretch","order","ActiveTags","offerSupertags","numberOfActiveTags","openSupertagModal","toggleTag","checkIsActive","useCheckIsActive","nextModifer","activeSupertagsTags","useActivateTag","ErrorBoundary","hasError","this","fallback","Component","keybinds","getElementById","GlobalKeybindings","handler","pressed","ctrlKey","createGlobalStyle","FullScreenCentered","ErrorScreen","themes","defaultThemeId","GlobalStyles","src","outOfResultsPicture","alt","LoadingScreen","SectionBody","Section","Terms","Wrapper","MODAL","backdrop","ModalSurface","modalWidth","Modal","close","blockEvent","ButtonRow","CellularWarningModal","search","onConfirm","onCancel","setAutoPlay","toggleAutoPlay","setPreloadVideos","togglePreloadVideos","setOriginals","toggleOriginals","eeek","CookieWrapper","COOKIEBAR","StyledSpan","CookieConfirmation","setCookies","handleAccept","StyledInput","SupertagModal","setName","setDescription","handleCreate","AnalyticsEventId","eventLogging","store","next","action","page_number","getState","initialPreferencesState","produce","draft","assign","saveTimeout","persistence","clearTimeout","setTimeout","firebaseFunctions","newPreferences","sourceTags","ratingTags","API","defaultPageSize","apiLocal","apiUrl1","apiUrl2","activeApi","setActiveApi","searchTerm","limit","json","doFuzzySearch","fetchTags","supertags","matchingSupertags","includes","details","matchingRating","matchingSourceTags","getIdToken","idToken","buildPostUrl","Authorization","apiResponse","comments_url","page","api","params","pid","i","apiRequests","hasMoreResults","minRating","getPosts","res","getAliases","sanitizedAliases","alias","getTags","getComments","middleware","composeWithDevTools","applyMiddleware","requests","migrations","reader","initialResultsState","Date","getTime","postCount","postIndex","findIndex","p","initialTagsState","newTag","initialFullscreenState","isEnabled","scrollIndex","enterFullscreen","exitFullscreen","setIndex","setScrollIndex","initialLikesState","now","initialModalsState","setOpenModal","initialSuggestionsState","setError","setModifier","combineReducers","persistConfig","storage","migrate","createMigrate","persistedReducer","persistReducer","rootReducer","createStore","persistor","persistStore","About","lazy","Privacy","Search","Preferences","Share","Stories","loadingScreen","App","loading","ThemedApp","isCellularWarningModalOpen","isSupertagModalOpen","isSignedIn","useLoadPreferences","Helmet","exact","path","component","PRIVACY","STORIES","TERMS","SHARE","isLocalhost","hostname","registerValidSW","swUrl","config","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","log","onUpdate","onSuccess","Sentry","dsn","integrations","Offline","tracesSampleRate","release","beforeBreadcrumb","breadcrumb","hint","category","startsWith","innerText","getAttribute","ReactDOM","render","contentType","status","ready","unregister","checkValidServiceWorker","serviceWorkerRegistration"],"mappings":"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","file":"static/js/main.fa9fa52d.chunk.js","sourcesContent":["import { ModalId, SuggestionsError } from '../data/types'\r\nimport * as r34 from 'r34-types'\r\nimport { PreferencesState } from './reducers/preferences'\r\n\r\n// Action Names\r\nexport const ADD_ALIASES = `r34-react/ADD_ALIASES`\r\nexport const ADD_POSTS = `r34-react/ADD_POSTS`\r\nexport const ADD_TAG = `r34-react/ADD_TAG`\r\nexport const CLOSE_MODAL = `r34-react/CLOSE_MODAL`\r\nexport const ENTER_FULLSCREEN = `r34-react/ENTER_FULLSCREEN`\r\nexport const EXIT_FULLSCREEN = 'r34-react/EXIT_FULLSCREEN'\r\nexport const FETCH_COMMENTS = `r34-react/FETCH_COMMENTS`\r\nexport const FETCH_PREFERENCES = `r34-react/FETCH_PREFERENCES`\r\nexport const FETCH_SUGGESTIONS = `r34-react/FETCH_SUGGESTIONS`\r\nexport const GET_MORE_RESULTS = `r34-react/GET_MORE_RESULTS`\r\nexport const GET_RESULTS = `r34-react/GET_RESULTS`\r\nexport const LIKE_POST = `r34-react/LIKE_POST`\r\nexport const OPEN_MODAL = `r34-react/OPEN_MODAL`\r\nexport const REMOVE_TAG = `r34-react/REMOVE_TAG`\r\nexport const SAVE_PREFERENCES = 'r34-react/SAVE_PREFERENCES'\r\nexport const SET_COMMENTS = `r34-react/SET_COMMENTS`\r\nexport const SET_FULLSCREEN_POST = `r34-react/SET_FULLSCREEN_POST`\r\nexport const SET_POSTS = `r34-react/SET_POSTS`\r\nexport const SET_PREFERENCE = `r34-react/SET_PREFERENCE`\r\nexport const SET_PREFERENCES = `r34-react/SET_PREFERENCES`\r\nexport const SET_SUGGESTIONS = `r34-react/SET_SUGGESTIONS`\r\nexport const SET_SUGGESTIONS_ERROR = `r34-react/SET_SUGGESTIONS_ERROR`\r\nexport const SET_SUGGESTIONS_MODIFIER = 'r34-react/SET_SUGGESTIONS_MODIFIER'\r\nexport const SCROLL_TO_POST = 'r34-react/SCROLL_TO_POST'\r\n\r\n// Action Types\r\ninterface AddTagAction {\r\n  type: typeof ADD_TAG\r\n  tag: r34.AnyBiasedTag\r\n}\r\n\r\ninterface RemoveTagAction {\r\n  type: typeof REMOVE_TAG\r\n  tagName: string\r\n}\r\n\r\ninterface AddAliasesAction {\r\n  type: typeof ADD_ALIASES\r\n  aliases: r34.AliasTag[]\r\n  forTag: string\r\n}\r\n\r\nexport interface AddPostsAction {\r\n  type: typeof ADD_POSTS\r\n  posts: r34.Post[]\r\n}\r\n\r\nexport interface SetPostsAction {\r\n  type: typeof SET_POSTS\r\n  posts: r34.Post[]\r\n  count: number\r\n  pageNumber?: number\r\n}\r\n\r\ninterface SetCommentsAction {\r\n  type: typeof SET_COMMENTS\r\n  postId: number\r\n  comments: r34.Comment[]\r\n}\r\n\r\ninterface FetchCommentsAction {\r\n  type: typeof FETCH_COMMENTS\r\n  postId: number\r\n}\r\n\r\ninterface SetPreferenceAction {\r\n  type: typeof SET_PREFERENCE\r\n  key: r34.PreferenceKey\r\n  value: any\r\n}\r\n\r\ninterface SetPreferencesAction {\r\n  type: typeof SET_PREFERENCES\r\n  preferences: Partial<PreferencesState>\r\n}\r\n\r\ninterface GetResultsAction {\r\n  type: typeof GET_RESULTS\r\n  pageNumber: number\r\n}\r\n\r\ninterface GetMoreResultsAction {\r\n  type: typeof GET_MORE_RESULTS\r\n}\r\n\r\ninterface EnterFullcreenAction {\r\n  type: typeof ENTER_FULLSCREEN\r\n  postId: number\r\n}\r\n\r\ninterface SetFullScreenPostAction {\r\n  type: typeof SET_FULLSCREEN_POST\r\n  index: number\r\n}\r\n\r\ninterface ExitFullscreenAction {\r\n  type: typeof EXIT_FULLSCREEN\r\n}\r\n\r\ninterface LikePostAction {\r\n  type: typeof LIKE_POST\r\n  postId: number\r\n}\r\n\r\ninterface OpenModalAction {\r\n  type: typeof OPEN_MODAL\r\n  modalId: ModalId\r\n}\r\n\r\ninterface CloseModalAction {\r\n  type: typeof CLOSE_MODAL\r\n}\r\n\r\ninterface SetSuggestionsAction {\r\n  type: typeof SET_SUGGESTIONS\r\n  suggestions: r34.AnyTag[]\r\n}\r\n\r\ninterface SetSuggestionsErrorAction {\r\n  type: typeof SET_SUGGESTIONS_ERROR\r\n  error: SuggestionsError\r\n}\r\n\r\ninterface FetchSuggestionsAction {\r\n  type: typeof FETCH_SUGGESTIONS\r\n  value: string\r\n  includeSupertags: boolean\r\n}\r\n\r\ninterface FetchPreferencesAction {\r\n  type: typeof FETCH_PREFERENCES\r\n}\r\n\r\ninterface SavePreferencesAction {\r\n  type: typeof SAVE_PREFERENCES\r\n}\r\n\r\ninterface SetSuggestionsModifierAction {\r\n  type: typeof SET_SUGGESTIONS_MODIFIER\r\n  modifier: r34.TagModifier\r\n}\r\n\r\ninterface ScrollToPostAction {\r\n  type: typeof SCROLL_TO_POST\r\n  index: number\r\n}\r\n\r\nexport type AppAction =\r\n  | AddAliasesAction\r\n  | AddPostsAction\r\n  | AddTagAction\r\n  | CloseModalAction\r\n  | EnterFullcreenAction\r\n  | ExitFullscreenAction\r\n  | FetchCommentsAction\r\n  | FetchPreferencesAction\r\n  | FetchSuggestionsAction\r\n  | GetMoreResultsAction\r\n  | GetResultsAction\r\n  | LikePostAction\r\n  | OpenModalAction\r\n  | RemoveTagAction\r\n  | SavePreferencesAction\r\n  | SetCommentsAction\r\n  | SetFullScreenPostAction\r\n  | SetPostsAction\r\n  | SetPreferenceAction\r\n  | SetPreferencesAction\r\n  | SetSuggestionsAction\r\n  | SetSuggestionsErrorAction\r\n  | SetSuggestionsModifierAction\r\n  | ScrollToPostAction\r\n\r\n// Action Creators\r\nexport function addTag(tag: r34.AnyBiasedTag): AddTagAction {\r\n  return {\r\n    type: ADD_TAG,\r\n    tag,\r\n  }\r\n}\r\n\r\nexport function removeTag(tagName: string): RemoveTagAction {\r\n  return {\r\n    type: REMOVE_TAG,\r\n    tagName,\r\n  }\r\n}\r\n\r\nexport function addAliases(aliases: r34.AliasTag[], forTag: string): AddAliasesAction {\r\n  return {\r\n    type: ADD_ALIASES,\r\n    aliases,\r\n    forTag,\r\n  }\r\n}\r\n\r\nexport function addPosts(posts: r34.Post[]): AddPostsAction {\r\n  return {\r\n    type: ADD_POSTS,\r\n    posts,\r\n  }\r\n}\r\n\r\nexport function setPosts(posts: r34.Post[], count: number, pageNumber: number = 0): SetPostsAction {\r\n  return {\r\n    type: SET_POSTS,\r\n    posts,\r\n    count,\r\n    pageNumber,\r\n  }\r\n}\r\n\r\nexport function setComments(postId: number, comments: r34.Comment[]): SetCommentsAction {\r\n  return {\r\n    type: SET_COMMENTS,\r\n    postId,\r\n    comments,\r\n  }\r\n}\r\n\r\nexport function fetchComments(postId: number): FetchCommentsAction {\r\n  return {\r\n    type: FETCH_COMMENTS,\r\n    postId,\r\n  }\r\n}\r\n\r\nexport function setPreference(key: r34.PreferenceKey, value: any): SetPreferenceAction {\r\n  return {\r\n    type: SET_PREFERENCE,\r\n    key,\r\n    value,\r\n  }\r\n}\r\n\r\nexport function setPreferences(preferences: Partial<PreferencesState>): SetPreferencesAction {\r\n  return {\r\n    type: SET_PREFERENCES,\r\n    preferences,\r\n  }\r\n}\r\n\r\nexport function getResults(pageNumber: number = 0): GetResultsAction {\r\n  return {\r\n    type: GET_RESULTS,\r\n    pageNumber,\r\n  }\r\n}\r\n\r\nexport function getMoreResults(): GetMoreResultsAction {\r\n  return {\r\n    type: GET_MORE_RESULTS,\r\n  }\r\n}\r\n\r\nexport function enterFullscreen(postId: number): EnterFullcreenAction {\r\n  return {\r\n    type: ENTER_FULLSCREEN,\r\n    postId,\r\n  }\r\n}\r\n\r\nexport function exitFullscreen(): ExitFullscreenAction {\r\n  return {\r\n    type: EXIT_FULLSCREEN,\r\n  }\r\n}\r\n\r\nexport function setFullscreenPost(index: number): SetFullScreenPostAction {\r\n  return {\r\n    type: SET_FULLSCREEN_POST,\r\n    index,\r\n  }\r\n}\r\n\r\nexport function scrollToPost(index: number): ScrollToPostAction {\r\n  return {\r\n    type: SCROLL_TO_POST,\r\n    index,\r\n  }\r\n}\r\n\r\nexport function likePost(postId: number): LikePostAction {\r\n  return {\r\n    type: LIKE_POST,\r\n    postId,\r\n  }\r\n}\r\n\r\nexport function openModal(modalId: ModalId): OpenModalAction {\r\n  return {\r\n    type: OPEN_MODAL,\r\n    modalId,\r\n  }\r\n}\r\n\r\nexport function closeModal(): CloseModalAction {\r\n  return {\r\n    type: CLOSE_MODAL,\r\n  }\r\n}\r\n\r\nexport function setSuggestions(suggestions: r34.AnyTag[]): SetSuggestionsAction {\r\n  return {\r\n    type: SET_SUGGESTIONS,\r\n    suggestions,\r\n  }\r\n}\r\n\r\nexport function setSuggestionsError(error: SuggestionsError): SetSuggestionsErrorAction {\r\n  return {\r\n    type: SET_SUGGESTIONS_ERROR,\r\n    error,\r\n  }\r\n}\r\n\r\nexport function fetchSuggestions(value: string, includeSupertags: boolean): FetchSuggestionsAction {\r\n  return {\r\n    type: FETCH_SUGGESTIONS,\r\n    value,\r\n    includeSupertags,\r\n  }\r\n}\r\n\r\nexport function fetchPreferences(): FetchPreferencesAction {\r\n  return {\r\n    type: FETCH_PREFERENCES,\r\n  }\r\n}\r\n\r\nexport function savePreferences(): SavePreferencesAction {\r\n  return {\r\n    type: SAVE_PREFERENCES,\r\n  }\r\n}\r\n\r\nexport function setSuggestionsModifier(modifier: r34.TagModifier): SetSuggestionsModifierAction {\r\n  return {\r\n    type: SET_SUGGESTIONS_MODIFIER,\r\n    modifier,\r\n  }\r\n}\r\n","import * as r34 from 'r34-types'\r\nimport { createSelector, defaultMemoize } from 'reselect'\r\nimport { isSupertag } from '../data/tagUtils'\r\nimport { ModalId } from '../data/types'\r\nimport { AppState } from './appState'\r\n\r\n// Simple selectors\r\nexport const selectActiveTags = (state: AppState) => state.tags.active\r\nexport const selectActiveThemeId = (state: AppState) => state.preferences.themeId\r\nexport const selectAliases = (state: AppState) => state.tags.aliases\r\nexport const selectAutoPlay = (state: AppState) => state.preferences.autoPlay\r\nexport const selectCookies = (state: AppState) => state.preferences.cookies\r\nexport const selectCount = (state: AppState) => state.results.count\r\nexport const selectFullsceenIndex = (state: AppState) => state.fullscreen.currentIndex\r\nexport const selectFullsceenState = (state: AppState) => state.fullscreen.isEnabled\r\nexport const selectHideSeen = (state: AppState) => state.preferences.hideSeen\r\nexport const selectOpenModalId = (state: AppState) => state.modals.openModal\r\nexport const selectOriginals = (state: AppState) => state.preferences.originals\r\nexport const selectPageNumber = (state: AppState) => state.results.pageNumber\r\nexport const selectPageSize = (state: AppState) => state.preferences.pageSize\r\nexport const selectPosts = (state: AppState) => state.results.posts\r\nexport const selectPreferences = (state: AppState) => state.preferences\r\nexport const selectPreloadVideos = (state: AppState) => state.preferences.preloadVideos\r\nexport const selectPreloadGifs = (state: AppState) => state.preferences.preloadVideos\r\nexport const selectRated = (state: AppState) => state.preferences.rated\r\nexport const selectRatedThreshold = (state: AppState) => state.preferences.ratedThreshold\r\nexport const selectResults = (state: AppState) => state.results\r\nexport const selectResultsLayout = (state: AppState) => state.preferences.resultsLayout\r\nexport const selectShowComments = (state: AppState) => state.preferences.showComments\r\nexport const selectShowMetadata = (state: AppState) => state.preferences.showMetadata\r\nexport const selectSort = (state: AppState) => state.preferences.sort\r\nexport const selectSuggestions = (state: AppState) => state.suggestions.entries\r\nexport const selectSuggestionsError = (state: AppState) => state.suggestions.error\r\nexport const selectSuggestionsModifier = (state: AppState) => state.suggestions.modifier\r\nexport const selectTagSuggestionCount = (state: AppState) => state.preferences.tagSuggestionsCount\r\nexport const selectUpdated = (state: AppState) => state.results.updated\r\nexport const selectAutoscrollDelay = (state: AppState) => state.preferences.autoscrollDelay\r\nexport const selectScrollIndex = (state: AppState) => state.fullscreen.scrollIndex\r\n\r\n// Memoized selectors\r\nexport const selectNumberOfActiveTags = createSelector(selectActiveTags, (tags) => Object.keys(tags).length)\r\nexport const selectAliasesAsList = createSelector(selectAliases, (aliases) => Object.values(aliases).flat())\r\nexport const selectHasResults = createSelector(selectPosts, (posts) => posts.length !== 0)\r\nexport const selectOutOfResults = createSelector(selectPosts, selectCount, (posts, count) => posts.length === count)\r\nexport const selectHasMoreResults = createSelector(selectOutOfResults, (outOfResults) => !outOfResults)\r\nexport const selectLastPage = createSelector(\r\n  selectCount,\r\n  selectPageSize,\r\n  (count, pageSize) => Math.ceil(count / pageSize) - 1\r\n)\r\nexport const selectFullScreenPost = createSelector(\r\n  selectPosts,\r\n  selectFullsceenIndex,\r\n  (posts, fullScreenIndex) => posts[fullScreenIndex]\r\n)\r\nexport const selectFullScreenIndex = createSelector(selectPosts, selectFullScreenPost, (posts, fullScreenPost) =>\r\n  fullScreenPost ? posts.indexOf(fullScreenPost) : -1\r\n)\r\nexport const selectMinRating = createSelector(selectRated, selectRatedThreshold, (rated, ratedThreshold) =>\r\n  rated ? ratedThreshold : 0\r\n)\r\nexport const selectNextIndex = createSelector(selectPosts, selectFullScreenIndex, (posts, selectedIndex) =>\r\n  selectedIndex + 1 < posts.length ? selectedIndex + 1 : undefined\r\n)\r\nexport const selectPreviousIndex = createSelector(selectFullScreenIndex, (selectedIndex) =>\r\n  selectedIndex > 0 ? selectedIndex - 1 : undefined\r\n)\r\nexport const selectSupertagModalOpen = createSelector(\r\n  selectOpenModalId,\r\n  (modalId) => modalId === ModalId.CREATE_SUPERTAG\r\n)\r\nexport const selectCellularWarningModalOpen = createSelector(\r\n  selectOpenModalId,\r\n  (modalId) => modalId === ModalId.CELLULAR_WARNING\r\n)\r\n\r\n// Parameterized selectors\r\nexport const selectPostById = defaultMemoize((id: number) => {\r\n  return createSelector(selectPosts, (posts) => {\r\n    return posts.find((post) => post.id === id) as r34.Post\r\n  })\r\n})\r\nexport const selectPostByIndex = defaultMemoize((index: number) => {\r\n  return createSelector(selectPosts, (posts) => {\r\n    return posts[index]\r\n  })\r\n})\r\n\r\nexport const selectAliasesByTagName = defaultMemoize((tagName: string) => {\r\n  return createSelector(selectAliases, (aliases) => {\r\n    return aliases[tagName]\r\n  })\r\n})\r\n\r\nexport const selectLikedByPostId = defaultMemoize((id: number) => (state: AppState) => id in state.likes)\r\n\r\nexport const selectActiveSupertagTags = createSelector(selectActiveTags, (activeTags) =>\r\n  Object.values(activeTags)\r\n    .filter(isSupertag)\r\n    .reduce((result, tag) => ({ ...result, ...tag.tags }), {})\r\n)\r\n","import { css } from 'styled-components'\r\nimport { flexRowGap, flexColumnGap, gap, defaultRowSpacing } from './gap'\r\nimport { transitionAll } from './theming'\r\nimport { PropsWithTheme } from './types'\r\n\r\nexport function multilineList({ theme }: PropsWithTheme) {\r\n  return css`\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    ${flexRowGap(theme.dimensions.bigSpacing)}\r\n    ${flexColumnGap(theme.dimensions.bigSpacing)}\r\n  `\r\n}\r\n\r\nexport function flexColumn() {\r\n  return css`\r\n    display: flex;\r\n    flex-direction: column;\r\n  `\r\n}\r\n\r\nexport function flexColumnWithGap({ theme }: PropsWithTheme) {\r\n  return css`\r\n    display: flex;\r\n    flex-direction: column;\r\n    ${flexColumnGap(theme.dimensions.bigSpacing)};\r\n  `\r\n}\r\n\r\nexport function gridWithGap({ theme }: PropsWithTheme) {\r\n  return css`\r\n    display: grid;\r\n    ${gap(theme.dimensions.bigSpacing)}\r\n  `\r\n}\r\n\r\nexport function flexRowWithGap({ theme }: PropsWithTheme) {\r\n  return css`\r\n    display: flex;\r\n    align-items: center;\r\n    ${flexRowGap(theme.dimensions.bigSpacing)};\r\n  `\r\n}\r\n\r\n/**\r\n * Limits content to a maximum width and centers it\r\n */\r\nexport function centeredMaxWidth({ theme }: PropsWithTheme) {\r\n  return css`\r\n    width: 100%;\r\n    max-width: ${theme.dimensions.bodyWidth};\r\n    margin-left: auto;\r\n    margin-right: auto;\r\n  `\r\n}\r\n\r\n/**\r\n * Fixed height and padding\r\n */\r\nexport function defaultBlock({ theme }: PropsWithTheme) {\r\n  return css`\r\n    height: ${theme.dimensions.blockHeight};\r\n    padding: 0 ${theme.dimensions.bigSpacing};\r\n  `\r\n}\r\n\r\nexport function fullscreenOverlay() {\r\n  return css`\r\n    position: fixed;\r\n    bottom: 0;\r\n    left: 0;\r\n    ${coverScreen};\r\n  `\r\n}\r\n\r\nexport function coverScreen() {\r\n  return css`\r\n    width: 100vw;\r\n    height: 100vh;\r\n  `\r\n}\r\n\r\nexport function buttonBaseStyle({ theme }: PropsWithTheme) {\r\n  return css`\r\n    display: inline-flex;\r\n    align-items: center;\r\n    place-content: center;\r\n\r\n    height: ${theme.dimensions.blockHeight};\r\n    cursor: pointer;\r\n    white-space: nowrap;\r\n    border-radius: ${theme.dimensions.borderRadius};\r\n    font-size: ${theme.fontSizes.content};\r\n    ${defaultRowSpacing}\r\n    ${transitionAll}\r\n  `\r\n}\r\n","import * as r34 from 'r34-types'\r\nimport { SuggestionsError } from './types'\r\n\r\n//#region Tag serialization\r\n\r\n/**\r\n * Accepts a map of all tags and serializes them into a string that can be used as a Querystring parameter\r\n */\r\nexport function serializeAllTags(tags: Record<string, r34.QueryTag | r34.Supertag>) {\r\n  const resolvedTags = flattenSupertags(Object.values(tags))\r\n  const tagsByModifier = groupTagsByModifier(resolvedTags)\r\n  const normalTags = [...tagsByModifier['+'], ...tagsByModifier['-']].map(serializeTag).join(' + ')\r\n  const optionalTags =\r\n    tagsByModifier['~'].length > 0 ? ` + ( ${tagsByModifier['~'].map(serializeTag).join(' ~ ')} )` : ''\r\n\r\n  return `${normalTags}${optionalTags}`\r\n}\r\n\r\n/**\r\n * Accepts a list that holds normal tags and supertags and unpacks all supertags.\r\n * The result contains all normal tags given plus all contents of the supertags given.\r\n */\r\nexport function flattenSupertags(tags: Array<r34.QueryTag | r34.Supertag>) {\r\n  let resolvedTags: r34.QueryTag[] = []\r\n\r\n  tags.forEach((tag) => {\r\n    if (isSupertag(tag)) {\r\n      Object.entries(tag.tags).forEach(([name, modifier]) => {\r\n        resolvedTags.push({ name, modifier })\r\n      })\r\n    } else {\r\n      resolvedTags.push(tag)\r\n    }\r\n  })\r\n\r\n  return resolvedTags\r\n}\r\n\r\n/**\r\n * Given a list of tags this function returns a record with an entry for each modifier countaining all tags of the original list that match that modifier.\r\n */\r\nexport function groupTagsByModifier(tags: r34.QueryTag[]) {\r\n  return tags.reduce(\r\n    (result, current) => {\r\n      if (!(current.modifier in result)) result[current.modifier] = []\r\n\r\n      result[current.modifier]?.push(current)\r\n\r\n      return result\r\n    },\r\n    { '+': [], '-': [], '~': [] } as Record<r34.TagModifier, r34.QueryTag[]>\r\n  )\r\n}\r\n\r\n/**\r\n * Serializes a tag for use in urls\r\n */\r\nexport function serializeTag(tag: r34.QueryTag) {\r\n  return `${tag.modifier === '-' ? '-' : ''}${serializeTagname(tag.name)}`\r\n}\r\n\r\n/**\r\n * Serializes tag names for use in api requests.\r\n */\r\nexport function serializeTagname(tagname: string) {\r\n  return encodeURIComponent(tagname.toLowerCase().replace(/ /g, '_'))\r\n}\r\n\r\n//#endregion\r\n\r\n//#region Query parameter construction\r\n\r\n/**\r\n * Constructs the tag parameter for getting posts from the api\r\n */\r\nexport function getTagParameter(\r\n  tags: Record<string, r34.QueryTag | r34.Supertag>,\r\n  minScore: number,\r\n  sort: r34.PostsSort\r\n) {\r\n  const tagParts = []\r\n\r\n  if (Object.keys(tags).length > 0) {\r\n    tagParts.push(serializeAllTags(tags))\r\n  }\r\n\r\n  if (minScore > 0) {\r\n    tagParts.push(encodeURIComponent(`score:>=${minScore}`))\r\n  }\r\n\r\n  if (sort !== 'date') {\r\n    tagParts.push(encodeURIComponent(`sort:${sort}:desc`))\r\n  }\r\n\r\n  return tagParts.join(' + ')\r\n}\r\n\r\n//#endregion\r\n\r\n//#region Typing\r\n\r\nexport function bias(tag: r34.Tag, modifier: r34.TagModifier): r34.BiasedTag {\r\n  return { ...tag, modifier }\r\n}\r\n\r\nexport function isBiased(tag: r34.Tag | r34.BiasedTag): tag is r34.BiasedTag {\r\n  return (tag as r34.BiasedTag).modifier !== undefined\r\n}\r\n\r\nexport function isSupertag(tag: unknown): tag is r34.Supertag {\r\n  return (tag as r34.Supertag).tags !== undefined\r\n}\r\n\r\nexport function getInterestingType(types: r34.TagType[]) {\r\n  return types.find((t) => !t.match(/^[general|ambiguous]$/))\r\n}\r\n\r\nexport function isSuggestionError(value: unknown): value is SuggestionsError {\r\n  return (value as SuggestionsError).message !== undefined\r\n}\r\n\r\n//#endregion\r\n\r\n//#region Compression\r\n\r\nfunction removeLeadingHastag(value: string) {\r\n  if (value[0] === '#') return value.substr(1)\r\n  else return value\r\n}\r\n\r\nexport function encodeSupertag(supertag: r34.Supertag) {\r\n  const payload = `${encodeURI(supertag.name)}/${encodeURI(supertag.description)}/${encodeURI(\r\n    Object.entries(supertag.tags)\r\n      .map(([t, m]) => `${t},${m}`)\r\n      .join(';')\r\n  )}`\r\n\r\n  return Buffer.from(payload).toString('base64')\r\n}\r\n\r\nexport function decodeSupertag(base64: string) {\r\n  const payload = Buffer.from(removeLeadingHastag(base64), 'base64').toString()\r\n\r\n  const parts = payload.split('/').map(decodeURI)\r\n\r\n  const supertag: r34.Supertag = {\r\n    name: parts[0],\r\n    description: parts[1],\r\n    tags: Object.fromEntries(parts[2].split(';').map((e) => e.split(','))),\r\n  }\r\n\r\n  return supertag\r\n}\r\n\r\n//#endregion\r\n","import { IconProp } from '@fortawesome/fontawesome-svg-core'\r\nimport {\r\n  faDeviantart,\r\n  faDiscord,\r\n  faGithub,\r\n  faGoogle,\r\n  faPatreon,\r\n  faTumblr,\r\n  faTwitter,\r\n} from '@fortawesome/free-brands-svg-icons'\r\nimport {\r\n  faArrowRight,\r\n  faArrowUp,\r\n  faBackward,\r\n  faCalendarDay,\r\n  faCaretDown,\r\n  faCheckCircle,\r\n  faCheckSquare,\r\n  faCodeBranch,\r\n  faCog,\r\n  faCopy,\r\n  faCopyright,\r\n  faDownload,\r\n  faExpand,\r\n  faExternalLinkAlt,\r\n  faForward,\r\n  faHashtag,\r\n  faHeart,\r\n  faImage,\r\n  faInfoCircle,\r\n  faLink,\r\n  faPen,\r\n  faPlus,\r\n  faRegistered,\r\n  faScroll,\r\n  faSearch,\r\n  faShareAlt,\r\n  faSignOutAlt,\r\n  faTags,\r\n  faTimes,\r\n  faTimesCircle,\r\n  faUndoAlt,\r\n  faUser,\r\n  faUserShield,\r\n  faWrench,\r\n} from '@fortawesome/free-solid-svg-icons'\r\nimport { FontAwesomeIcon, FontAwesomeIconProps } from '@fortawesome/react-fontawesome'\r\nimport React from 'react'\r\n\r\n/**\r\n * Component factory that shortens the definition of a new icon considerably\r\n */\r\nconst bindIcon = (icon: IconProp) =>\r\n  React.memo((props: Omit<FontAwesomeIconProps, 'icon'>) => (\r\n    <FontAwesomeIcon data-testid='icon' icon={icon} {...props} />\r\n  ))\r\n\r\nexport const ArrowDown = bindIcon(faCaretDown)\r\nexport const ArtistIcon = bindIcon(faPen)\r\nexport const CalendarIcon = bindIcon(faCalendarDay)\r\nexport const CharacterIcon = bindIcon(faUser)\r\nexport const CheckIcon = bindIcon(faCheckSquare)\r\nexport const CloseIcon = bindIcon(faTimes)\r\nexport const CodeBranchIcon = bindIcon(faCodeBranch)\r\nexport const CopyIcon = bindIcon(faCopy)\r\nexport const CopyrightIcon = bindIcon(faCopyright)\r\nexport const DeviantArtIcon = bindIcon(faDeviantart)\r\nexport const DiscordIcon = bindIcon(faDiscord)\r\nexport const DownloadIcon = bindIcon(faDownload)\r\nexport const ExpandIcon = bindIcon(faExpand)\r\nexport const ExternalLinkIcon = bindIcon(faExternalLinkAlt)\r\nexport const FailedIcon = bindIcon(faTimesCircle)\r\nexport const GithubIcon = bindIcon(faGithub)\r\nexport const GoogleIcon = bindIcon(faGoogle)\r\nexport const HeartIcon = bindIcon(faHeart)\r\nexport const ImageIcon = bindIcon(faImage)\r\nexport const LinkIcon = bindIcon(faLink)\r\nexport const MetaDataIcon = bindIcon(faInfoCircle)\r\nexport const PatreonIcon = bindIcon(faPatreon)\r\nexport const PlusIcon = bindIcon(faPlus)\r\nexport const PrivacyIcon = bindIcon(faUserShield)\r\nexport const RatingIcon = bindIcon(faRegistered)\r\nexport const SearchIcon = bindIcon(faSearch)\r\nexport const PreferencesIcon = bindIcon(faCog)\r\nexport const ShareIcon = bindIcon(faShareAlt)\r\nexport const SignOutIcon = bindIcon(faSignOutAlt)\r\nexport const SourceIcon = bindIcon(faHashtag)\r\nexport const SuccessIcon = bindIcon(faCheckCircle)\r\nexport const SupertagIcon = bindIcon(faTags)\r\nexport const TermsIcon = bindIcon(faScroll)\r\nexport const TumblrIcon = bindIcon(faTumblr)\r\nexport const TwitterIcon = bindIcon(faTwitter)\r\nexport const UndoIcon = bindIcon(faUndoAlt)\r\nexport const WrenchIcon = bindIcon(faWrench)\r\nexport const ForwardIcon = bindIcon(faForward)\r\nexport const BackwardIcon = bindIcon(faBackward)\r\nexport const SubmitIcon = bindIcon(faArrowRight)\r\nexport const ArrowUp = bindIcon(faArrowUp)\r\n","/**\r\n * Tabs displayed in Post details\r\n */\r\nexport type ActiveTab = 'tags' | 'comments' | 'metadata'\r\n\r\n/**\r\n * All routes of the app.\r\n */\r\nexport enum RouteName {\r\n  SEARCH = '/',\r\n  PREFERENCES = '/preferences',\r\n  ABOUT = '/about',\r\n  PRIVACY = '/privacy',\r\n  TERMS = '/terms',\r\n  STORIES = '/stories',\r\n  SHARE = '/share',\r\n}\r\n\r\n/**\r\n * All modals the app can display.\r\n */\r\nexport enum ModalId {\r\n  CREATE_SUPERTAG,\r\n  CELLULAR_WARNING,\r\n}\r\n\r\nexport type EmptyCallback = () => void\r\n\r\n/**\r\n * One-time definition of an empty function. Reusing this improves React's performance as it does not break memoization.\r\n */\r\nexport const NO_OP = () => {}\r\n\r\n/**\r\n * Error sent from the backend when too many tag results were found\r\n */\r\nexport type SuggestionsError = { message: string; results: number }\r\n\r\n/**\r\n * direct: Tag is part of active tags\r\n * indirect: Tag is part of a supertag that is in active tags\r\n * no: Tag is not part of supertags at all\r\n */\r\nexport type TagIsActive = 'direct' | 'indirect' | 'no'\r\n\r\n/**\r\n * Unit for display in the TagSelector dropdown\r\n */\r\nexport type CountUnit = 'tags' | 'posts'\r\n","import styled, { css } from 'styled-components'\r\nimport { buttonBaseStyle } from '../../styled/mixins/layout'\r\nimport { dropShadow } from '../../styled/mixins/shadow'\r\nimport { defaultBorder, primary, transitionAll } from '../../styled/mixins/theming'\r\n\r\nconst TextButton = styled.button`\r\n  ${buttonBaseStyle}\r\n`\r\n\r\nexport const LinkButton = styled.a(\r\n  ({ theme }) => css`\r\n    ${buttonBaseStyle}\r\n\r\n    gap: ${theme.dimensions.bigSpacing};\r\n    padding: 0 ${theme.dimensions.hugeSpacing};\r\n    background-color: ${theme.colors.layerBg};\r\n    border-radius: ${theme.dimensions.borderRadius};\r\n    color: ${theme.colors.text};\r\n\r\n    :visited {\r\n      color: ${theme.colors.text} !important;\r\n      text-decoration: none !important;\r\n    }\r\n\r\n    :hover {\r\n      opacity: 0.8;\r\n      text-decoration: none !important;\r\n    }\r\n\r\n    :active {\r\n      opacity: 0.6;\r\n      text-decoration: none !important;\r\n    }\r\n  `\r\n)\r\n\r\nexport const InvisButton = styled.button(\r\n  ({ theme }) => css`\r\n    background-color: transparent;\r\n    border: none;\r\n    padding: ${theme.dimensions.bigSpacing};\r\n    color: ${theme.colors.text};\r\n    cursor: pointer;\r\n    font-size: ${theme.fontSizes.content};\r\n\r\n    ${dropShadow}\r\n\r\n    svg {\r\n      ${transitionAll}\r\n    }\r\n  `\r\n)\r\n\r\nexport const PrimaryButton = styled(TextButton)(\r\n  ({ theme }) => css`\r\n    ${primary}\r\n\r\n    gap: ${theme.dimensions.bigSpacing};\r\n    padding: 0 ${theme.dimensions.hugeSpacing};\r\n  `\r\n)\r\n\r\nexport const BlockButton = styled(PrimaryButton)`\r\n  width: 100%;\r\n`\r\n\r\nexport const AddButton = styled(PrimaryButton)(\r\n  ({ theme }) => css`\r\n    border-radius: 0 ${theme.dimensions.borderRadius} ${theme.dimensions.borderRadius} 0;\r\n    min-width: ${theme.dimensions.blockHeight};\r\n  `\r\n)\r\n\r\nexport const ModifierButton = styled(TextButton)(\r\n  ({ theme }) => css`\r\n    background-color: transparent;\r\n    min-width: 48px;\r\n    font-size: 24px;\r\n\r\n    :focus {\r\n      text-decoration: none;\r\n    }\r\n\r\n    ${defaultBorder}\r\n    border-right-width: 0;\r\n    border-radius: ${theme.dimensions.borderRadius} 0 0 ${theme.dimensions.borderRadius};\r\n  `\r\n)\r\n","import { css } from 'styled-components'\r\nimport { defaultBlock } from './layout'\r\nimport { PropsWithTheme, SupportsDisable } from './types'\r\n\r\n/**\r\n * Adds a short transition to every attribute\r\n */\r\nexport function transitionAll({ theme }: PropsWithTheme) {\r\n  return css`\r\n    transition: all ${theme.timings.transitionTime} linear;\r\n  `\r\n}\r\n\r\n/**\r\n * Sets border-radius to the default\r\n */\r\nexport function borderRadius({ theme }: PropsWithTheme) {\r\n  return css`\r\n    border-radius: ${theme.dimensions.borderRadius};\r\n  `\r\n}\r\n\r\n/**\r\n * Gives elements a border\r\n */\r\nexport function defaultBorder({ theme }: PropsWithTheme) {\r\n  return css`\r\n    border-color: ${theme.colors.accentColor};\r\n    border-width: ${theme.dimensions.borderWidth};\r\n    border-style: solid;\r\n    ${borderRadius}\r\n  `\r\n}\r\n\r\n/**\r\n * Accent colored element with hover/focus/active/disabled states\r\n */\r\nexport function primary({ theme, disabled }: PropsWithTheme & Partial<SupportsDisable>) {\r\n  return css`\r\n    color: ${theme.colors.backgroundColor};\r\n    background-color: ${disabled ? theme.colors.subduedText : theme.colors.accentColor};\r\n    border: none;\r\n\r\n    ${transitionAll}\r\n    ${pointerInteraction}\r\n  `\r\n}\r\n\r\n/**\r\n * Transparent with text and border in accentcolor\r\n */\r\nexport function secondary({ theme, disabled }: PropsWithTheme & Partial<SupportsDisable>) {\r\n  const foreground = disabled ? theme.colors.subduedText : theme.colors.accentColor\r\n\r\n  return css`\r\n    color: ${foreground};\r\n    background-color: transparent;\r\n\r\n    ${transitionAll}\r\n    ${defaultBorder}\r\n    ${pointerInteraction}\r\n  `\r\n}\r\n\r\nexport function focus({ theme }: PropsWithTheme) {\r\n  return css`\r\n    :focus {\r\n      color: ${theme.colors.backgroundColor2};\r\n      border-color: ${theme.colors.backgroundColor2};\r\n    }\r\n  `\r\n}\r\n\r\nexport function pointerInteraction({ disabled }: PropsWithTheme & Partial<SupportsDisable>) {\r\n  return disabled\r\n    ? ''\r\n    : css`\r\n        :hover {\r\n          filter: brightness(120%);\r\n        }\r\n\r\n        :focus {\r\n          ${focus}\r\n        }\r\n\r\n        :active {\r\n          filter: brightness(90%);\r\n        }\r\n      `\r\n}\r\n\r\n/**\r\n * Element will look like a new layer\r\n */\r\nexport function layer({ theme }: PropsWithTheme) {\r\n  return css`\r\n    background-color: ${theme.colors.layerBg};\r\n    ${borderRadius}\r\n  `\r\n}\r\n\r\n/**\r\n * Element will look like a new layer\r\n */\r\nexport function solidLayer({ theme }: PropsWithTheme) {\r\n  return css`\r\n    background-color: ${theme.colors.layerBgSolid};\r\n    ${borderRadius}\r\n  `\r\n}\r\n\r\n/**\r\n * Height and coloring for most inputs\r\n */\r\nexport function defaultInput({ theme }: PropsWithTheme) {\r\n  return css`\r\n    ${defaultBorder}\r\n    ${defaultBlock}\r\n   \r\n    background-color: ${theme.colors.backgroundColor2};\r\n    cursor: pointer;\r\n  `\r\n}\r\n","import { css } from 'styled-components'\r\nimport { supportsFlexGap, supportsGap } from '../../data/browserUtils'\r\nimport { PropsWithTheme } from './types'\r\n\r\nexport function gap(amount: string) {\r\n  return supportsGap\r\n    ? css`\r\n        gap: ${amount};\r\n      `\r\n    : css`\r\n        > :not(:last-child) {\r\n          margin-right: ${amount};\r\n          margin-bottom: ${amount};\r\n        }\r\n      `\r\n}\r\n\r\nexport function flexRowGap(amount: string) {\r\n  return supportsFlexGap\r\n    ? css`\r\n        gap: ${amount};\r\n      `\r\n    : css`\r\n        > :not(:last-child) {\r\n          margin-right: ${amount};\r\n        }\r\n      `\r\n}\r\n\r\nexport function flexColumnGap(amount: string) {\r\n  return supportsFlexGap\r\n    ? css`\r\n        gap: ${amount};\r\n      `\r\n    : css`\r\n        > :not(:last-child) {\r\n          margin-bottom: ${amount};\r\n        }\r\n      `\r\n}\r\n\r\n/**\r\n * `gap` and `padding` set to `bigSpacing`\r\n */\r\nexport function defaultSpacing({ theme }: PropsWithTheme) {\r\n  return css`\r\n    ${gap(theme.dimensions.bigSpacing)};\r\n    padding: ${theme.dimensions.bigSpacing};\r\n  `\r\n}\r\n\r\n/**\r\n * `gap` and `padding` set to `bigSpacing`. `padding` only horizontally.\r\n * Use `align-items: center` or similar to handle veritcal padding\r\n */\r\nexport function defaultRowSpacing({ theme }: PropsWithTheme) {\r\n  return css`\r\n    ${gap(theme.dimensions.bigSpacing)};\r\n    padding: 0 ${theme.dimensions.bigSpacing};\r\n  `\r\n}\r\n","import firebase from 'firebase/app'\r\nimport 'firebase/auth'\r\n\r\nlet initialized = false\r\nlet googleAuthProvider!: firebase.auth.GoogleAuthProvider\r\n\r\nexport function init() {\r\n  googleAuthProvider = new firebase.auth.GoogleAuthProvider()\r\n  initialized = true\r\n}\r\n\r\nexport function signIn() {\r\n  if (initialized) {\r\n    firebase\r\n      .auth()\r\n      .signInWithPopup(googleAuthProvider)\r\n      .catch((error) => {\r\n        console.error('Sign in failed:', error.code, error.message)\r\n      })\r\n  } else {\r\n    console.warn('Cannot sign in before initialization')\r\n  }\r\n}\r\n\r\nexport async function signOut() {\r\n  if (initialized) {\r\n    return await firebase.auth().signOut()\r\n  } else {\r\n    console.warn('Cannot sign out before initialization')\r\n  }\r\n}\r\n","import firebase from 'firebase/app'\r\nimport 'firebase/auth'\r\nimport 'firebase/firestore'\r\nimport { SupertagData, TagModifier, User } from 'r34-types'\r\nimport { sha256 } from '../data/encryption'\r\nimport { PreferencesState } from '../redux/reducers/preferences'\r\nimport { GenericConverter } from './genericConverter'\r\n\r\nlet initialized = false\r\nlet userConverter!: GenericConverter<User>\r\n\r\nexport function init() {\r\n  userConverter = new GenericConverter<User>()\r\n  initialized = true\r\n}\r\n\r\nasync function getUserDoc() {\r\n  if (!initialized) {\r\n    console.warn('Cannot get userDoc. Not initialized yet')\r\n    return undefined\r\n  }\r\n  try {\r\n    const { currentUser } = firebase.auth()\r\n    const email = currentUser?.email\r\n\r\n    if (email) {\r\n      const key = await sha256(email)\r\n      const userDoc = firebase.firestore().collection('users').doc(key)\r\n      return userDoc\r\n    }\r\n\r\n    return undefined\r\n  } catch (err) {\r\n    console.warn('Failed to get user document:', err)\r\n    return undefined\r\n  }\r\n}\r\n\r\nasync function getUserData() {\r\n  const userDoc = await getUserDoc()\r\n\r\n  if (userDoc) {\r\n    let userSnap = await userDoc.withConverter(userConverter).get()\r\n\r\n    const userData = userSnap.data()\r\n    return userData\r\n  }\r\n\r\n  return undefined\r\n}\r\n\r\nexport async function getPreferences() {\r\n  const userData = await getUserData()\r\n\r\n  if (userData) return userData.preferences\r\n\r\n  return undefined\r\n}\r\n\r\nexport async function setPreferences(preferences: PreferencesState) {\r\n  const userDoc = await getUserDoc()\r\n\r\n  await userDoc?.set({ preferences: preferences })\r\n}\r\n\r\nexport async function resetSeenPosts() {\r\n  console.warn('no longer supported')\r\n}\r\n\r\nexport async function getSupertags() {\r\n  const userDoc = await getUserDoc()\r\n\r\n  if (userDoc) {\r\n    const snap = await userDoc.collection('supertags').get()\r\n    const result: Record<string, SupertagData> = {}\r\n\r\n    snap.forEach((doc) => {\r\n      result[doc.id] = doc.data() as SupertagData\r\n    })\r\n\r\n    return result\r\n  }\r\n\r\n  return undefined\r\n}\r\n\r\nexport async function addSupertag(name: string, description: string, tags: Record<string, TagModifier>) {\r\n  const userDoc = await getUserDoc()\r\n\r\n  userDoc?.collection('supertags').doc(name).set({ description, tags })\r\n}\r\n\r\nexport async function removeSupertag(name: string) {\r\n  const userDoc = await getUserDoc()\r\n\r\n  userDoc?.collection('supertags').doc(name).delete()\r\n}\r\n\r\nexport async function setTagsOfSupertag(name: string, tags: Record<string, TagModifier>) {\r\n  const userDoc = await getUserDoc()\r\n\r\n  userDoc?.collection('supertags').doc(name).update({ tags })\r\n}\r\n","import firebase from 'firebase/app'\r\n\r\nexport class GenericConverter<T> {\r\n  toFirestore(data: T): firebase.firestore.DocumentData {\r\n    return data\r\n  }\r\n  fromFirestore(snapshot: firebase.firestore.QueryDocumentSnapshot, options: firebase.firestore.SnapshotOptions): T {\r\n    const data = snapshot.data(options)!\r\n    return data as T\r\n  }\r\n}\r\n","import firebase from 'firebase/app'\r\nimport 'firebase/analytics'\r\nimport { SearchEvent } from '../analytics/events'\r\n\r\nlet initialized = false\r\n\r\nexport function init() {\r\n  initialized = true\r\n}\r\n\r\nexport async function logEvent(event: SearchEvent) {\r\n  if (initialized) {\r\n    firebase.analytics().logEvent<typeof event.id>(event.id, event.payload)\r\n  }\r\n}\r\n","import firebase from 'firebase/app'\r\nimport 'firebase/analytics'\r\nimport 'firebase/auth'\r\nimport 'firebase/firestore'\r\nimport * as signIn from './signIn'\r\nimport * as storage from './storage'\r\nimport * as analytics from './analytics'\r\n\r\nlet initialized = false\r\nconst firebaseConfig = {\r\n  apiKey: 'AIzaSyBHdepwE7M4Byu2lFtX2s__9COcMdvXu7Q',\r\n  authDomain: 'r34-react.firebaseapp.com',\r\n  databaseURL: 'https://r34-react.firebaseio.com',\r\n  projectId: 'r34-react',\r\n  storageBucket: 'r34-react.appspot.com',\r\n  messagingSenderId: '844749417844',\r\n  appId: '1:844749417844:web:11fa1fda0e14f1ac2dd021',\r\n  measurementId: 'G-27J3QXZ8YR',\r\n}\r\n\r\nexport function init() {\r\n  firebase.initializeApp(firebaseConfig)\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  initialized = true\r\n\r\n  signIn.init()\r\n  storage.init()\r\n  analytics.init()\r\n}\r\n\r\nif (window.navigator.onLine) {\r\n  init()\r\n} else {\r\n  window.addEventListener(\r\n    'online',\r\n    () => {\r\n      init()\r\n    },\r\n    { once: true }\r\n  )\r\n}\r\n\r\nexport * from './analytics'\r\nexport * from './signIn'\r\nexport * from './storage'\r\n","import styled, { css } from 'styled-components'\r\nimport { flexRowWithGap } from '../../styled/mixins/layout'\r\n\r\nexport const Title = styled.h2(\r\n  ({ theme }) => css`\r\n    font-size: ${theme.fontSizes.bigTitle};\r\n    font-weight: lighter;\r\n    text-align: center;\r\n  `\r\n)\r\n\r\nexport const BigTitle = styled.h1(\r\n  ({ theme }) => css`\r\n    ${flexRowWithGap({ theme })}\r\n\r\n    justify-content: center;\r\n    font-size: ${theme.fontSizes.bigTitle};\r\n    font-weight: lighter;\r\n    text-align: center;\r\n  `\r\n)\r\n\r\nexport const SmallTitle = styled.h3(\r\n  ({ theme }) => css`\r\n    font-size: ${theme.fontSizes.content};\r\n  `\r\n)\r\n\r\nexport const Faded = styled.span(\r\n  ({ theme }) => css`\r\n    color: ${theme.colors.subduedText};\r\n  `\r\n)\r\n","export enum ZIndex {\r\n  POST = 1,\r\n  OVERLAY = 2,\r\n  COOKIEBAR = 100,\r\n  DROPDOWN = 3,\r\n  MODAL = 1000,\r\n}\r\n","export const supportsFlexGap = (() => {\r\n  // create flex container with row-gap set\r\n  var flex = document.createElement('div')\r\n  flex.style.display = 'flex'\r\n  flex.style.flexDirection = 'column'\r\n  flex.style.rowGap = '1px'\r\n\r\n  // create two, elements inside it\r\n  flex.appendChild(document.createElement('div'))\r\n  flex.appendChild(document.createElement('div'))\r\n\r\n  // append to the DOM (needed to obtain scrollHeight)\r\n  document.body.appendChild(flex)\r\n  var isSupported = flex.scrollHeight === 1 // flex container should be 1px high from the row-gap\r\n  //@ts-expect-error\r\n  flex.parentNode.removeChild(flex)\r\n\r\n  return isSupported\r\n})()\r\n\r\nexport const supportsGap = 'gap' in document.body.style\r\nexport const supportsAspectRatio = 'aspect-ratio' in document.body.style\r\nexport const supportsObjectFit = 'object-fit' in document.body.style\r\nexport const supportsFullscreen = document.fullscreenEnabled\r\nexport const supportsNetworkInformationAPI =\r\n  'connection' in navigator || 'mozConnection' in navigator || 'webkitConnection' in navigator\r\nexport const supportsLocalStorage = Boolean(localStorage)\r\n\r\nexport async function openFullscreen(element: Element) {\r\n  if (document.fullscreenEnabled && document.fullscreenElement === null) {\r\n    try {\r\n      const result = element.requestFullscreen()\r\n\r\n      if ('then' in result) {\r\n        return await result\r\n      }\r\n\r\n      return Promise.resolve(result)\r\n    } catch (err) {\r\n      // this causes a warning in console. So nothing to do for me here.\r\n    }\r\n  }\r\n\r\n  return null\r\n}\r\n\r\nexport async function closeFullscreen() {\r\n  if (document.fullscreenEnabled && document.fullscreenElement !== null) {\r\n    try {\r\n      const result = document.exitFullscreen()\r\n\r\n      if ('then' in result) {\r\n        return await result\r\n      }\r\n\r\n      return Promise.resolve(result)\r\n    } catch (err) {\r\n      // this causes a warning in console. So nothing to do for me here.\r\n    }\r\n  }\r\n\r\n  return null\r\n}\r\n","/**\n * Converts a list of objects into a map.\n * @param list The original list\n * @param keyProp The keyProp parameter defines which property of the objects will be used as the index for the map\n */\nexport const listToMap = <T>(list: T[], keyProp: string): Record<string, T> => {\n  return list.reduce((result: Record<string, T>, current: any) => {\n    result[current[keyProp]] = current\n    return result\n  }, {})\n}\n\n/**\n * Returns a URL object when the value is a hyperlink. Else undefined\n */\nexport function parseUrl(value: string) {\n  try {\n    return new URL(value)\n  } catch (err) {\n    // This is expected. If this method cannot parse the url it will return undefined.\n    return undefined\n  }\n}\n\n/**\n * converts a version like \"1.2.7\" into 127\n */\nexport function versionToNumber(majorMinorPatch: string) {\n  return Number(majorMinorPatch.split('.').join(''))\n}\n\n/**\n * Hacky ass way to download images cross origin. Could solve this by hosting both the app and the api on the same domain.\n */\nexport function download(url: string) {\n  const filename = url.split('/').pop() || ''\n\n  fetch(url, {\n    headers: new Headers({\n      Origin: window.location.origin,\n    }),\n    mode: 'cors',\n  })\n    .then((response) => response.blob())\n    .then((blob) => {\n      var a = document.createElement('a')\n      a.download = filename\n      a.href = window.URL.createObjectURL(blob)\n      document.body.appendChild(a)\n      a.click()\n      a.remove()\n    })\n    .catch((e) => console.error('Download error:', e))\n}\n\n/**\n * Returns the current version of the project\n */\nexport function getVersion() {\n  // Some browsers fail to get environment variables. In that case return unknown.\n  if (process?.env?.REACT_APP_VERSION) {\n    return process.env.REACT_APP_VERSION\n  }\n\n  return 'unknown'\n}\n\n/**\n * Render ready version.\n */\nexport function getVersionString() {\n  const version = getVersion()\n\n  return version === 'unknown' ? 'Latest Release' : `Version ${version}`\n}\n\n/**\n * Returns the correct source based on preferences\n */\nexport function getCorrectSource(loadOriginal: boolean, big_src: string, small_src: string) {\n  const source = loadOriginal ? big_src : small_src\n  return source\n}\n\nexport function boolToNumber(value: boolean) {\n  return value ? 1 : 0\n}\n\nexport const randomBelow = (max: number) => Math.floor(Math.random() * max)\n","import { useCallback } from 'react'\nimport { useDispatch } from 'react-redux'\nimport { AnyAction } from 'redux'\n\n/**\n * A hook that simplifies usage of simple (unparameterized) Redux actions\n */\nexport default function useAction<T extends () => AnyAction>(actionCreator: T) {\n  const dispatch = useDispatch()\n\n  return useCallback(() => dispatch(actionCreator()), [actionCreator, dispatch])\n}\n","import { useCallback } from 'react'\r\nimport { PreferenceKey } from 'r34-types'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { setPreference } from '../redux/actions'\r\nimport { PreferencesState } from '../redux/reducers/preferences'\r\nimport { selectPreferences } from '../redux/selectors'\r\n\r\n/**\r\n * useState for preferences using redux instead of local state.\r\n */\r\nexport default function usePreference<T extends PreferenceKey>(\r\n  key: T\r\n): [PreferencesState[T], (value: PreferencesState[T]) => void] {\r\n  const dispatch = useDispatch()\r\n  const preferences = useSelector(selectPreferences)\r\n  const setValue = useCallback((value: any) => dispatch(setPreference(key, value)), [dispatch, key])\r\n\r\n  return [preferences[key], setValue]\r\n}\r\n","import styled from 'styled-components'\r\nimport { defaultSpacing } from '../../styled/mixins/gap'\r\nimport { layer, solidLayer } from '../../styled/mixins/theming'\r\n\r\n/**\r\n * Includes spacing and background color\r\n */\r\nexport const Surface = styled.div`\r\n  display: grid;\r\n  ${defaultSpacing}\r\n  ${layer}\r\n  width: 100%;\r\n`\r\n\r\n/**\r\n * Includes spacing and background color\r\n */\r\nexport const SolidSurface = styled.div`\r\n  ${defaultSpacing}\r\n  ${solidLayer}\r\n  width: 100%;\r\n`\r\n","import { parseUrl } from '../data/utils'\n\n/**\n * Transforms a number into a shortened version for rendering.\n * Useful as it takes up less space.\n */\nexport const formatCount = (value: number) => {\n  if (value / 1e6 >= 1) {\n    return `${Math.trunc(value / 1e6)}M`\n  }\n\n  if (value >= 1e3) {\n    return `${Math.trunc(value / 1e3)}K`\n  }\n\n  return value.toString()\n}\n\n/**\n * Formats source strings for rendering\n */\nexport const formatSource = (source: string) => {\n  const url = parseUrl(source)\n  return url ? url.host : source\n}\n\n/**\n * Seconds to mm:ss formatter\n */\nexport function formatDuration(duration: number) {\n  const min = Math.trunc(duration / 60)\n  const sec = Math.trunc(duration % 60)\n\n  return min + ':' + (sec < 10 ? '0' : '') + sec\n}\n\n/**\n * Formats tag names for rendering.\n */\nexport function formatTagname(tagname: string) {\n  return tagname\n    .replace(/_/g, ' ')\n    .replace(/source:/g, '')\n    .replace(/rating:/g, '')\n}\n\n/**\n * Formats tags with their count if possible\n */\nexport function formatTagnameAndCount(name: string, count?: number) {\n  return count ? `${formatTagname(name)} (${formatCount(count)})` : formatTagname(name)\n}\n\nconst z = (value: number) => (value < 10 ? `0${value}` : value.toString())\n\n/**\n * Returns a string containing date and time of agiven Date object\n */\nexport function formatDatetime(date: Date) {\n  const dd = z(date.getDate())\n  const MM = z(date.getMonth() + 1) // zero indexed\n  const yyyy = date.getFullYear()\n  const hh = z(date.getHours())\n  const mm = z(date.getMinutes())\n\n  return `${dd}/${MM}/${yyyy} ${hh}:${mm}`\n}\n\n/**\n * Returns a human friendly approximation of a given time\n */\nexport function formatTime(milliseconds: number) {\n  if (milliseconds >= 315576e5) {\n    return formatUnit(milliseconds, 315576e5, 'year')\n  }\n\n  if (milliseconds >= 26297568e2) {\n    return formatUnit(milliseconds, 26297568e2, 'month')\n  }\n\n  if (milliseconds >= 6048e5) {\n    return formatUnit(milliseconds, 6048e5, 'week')\n  }\n\n  if (milliseconds >= 854e5) {\n    return formatUnit(milliseconds, 854e5, 'day')\n  }\n\n  if (milliseconds >= 36e5) {\n    return formatUnit(milliseconds, 36e5, 'hour')\n  }\n\n  if (milliseconds >= 6e4) {\n    return formatUnit(milliseconds, 6e4, 'minute')\n  }\n\n  if (milliseconds >= 1e3) {\n    return formatUnit(milliseconds, 1e3, 'second')\n  }\n\n  return `${milliseconds} ms`\n}\n\nexport function formatUnit(value: number, unitSize: number, unit: string) {\n  const result = (value / unitSize).toFixed(0)\n\n  const unitString = result === '1' ? unit : `${unit}s`\n\n  return `${result} ${unitString}`\n}\n","import styled from 'styled-components'\r\nimport { flexRowWithGap } from '../../styled/mixins/layout'\r\n\r\nconst FlexPair = styled.div`\r\n  ${flexRowWithGap}\r\n`\r\n\r\nexport default FlexPair\r\n","import styled from 'styled-components'\r\nimport { flexMedia, preserveAspectRatio } from '../../styled/mixins/media'\r\n\r\nconst FlexImage = styled.img`\r\n  ${flexMedia}\r\n  ${preserveAspectRatio}\r\n`\r\n\r\nexport default FlexImage\r\n","import React from 'react'\r\n\r\ninterface UseOnlineChangeOptions {\r\n  onOnline?: () => void\r\n  onOffline?: () => void\r\n}\r\n\r\nexport function useOnlineChange(options?: UseOnlineChangeOptions) {\r\n  const [isOnline, setIsOnline] = React.useState(window.navigator.onLine)\r\n\r\n  React.useEffect(() => {\r\n    const listenter = () => {\r\n      setIsOnline(true)\r\n      options?.onOnline?.()\r\n    }\r\n    window.addEventListener('online', listenter)\r\n    return () => window.removeEventListener('online', listenter)\r\n  })\r\n\r\n  React.useEffect(() => {\r\n    const listenter = () => {\r\n      setIsOnline(false)\r\n      options?.onOffline?.()\r\n    }\r\n    window.addEventListener('offline', listenter)\r\n    return () => window.removeEventListener('offline', listenter)\r\n  })\r\n\r\n  return isOnline\r\n}\r\n","import React, { MouseEventHandler } from 'react'\r\nimport FlexPair from './FlexPair'\r\nimport Toggle from './Toggle'\r\n\r\ninterface LabeledToggleProps {\r\n  children: React.ReactNode\r\n  value: boolean\r\n  onToggle: MouseEventHandler\r\n  className?: string\r\n}\r\n\r\nexport default function LabeledToggle(props: LabeledToggleProps) {\r\n  const { children, value, onToggle, className } = props\r\n\r\n  return (\r\n    <FlexPair className={className}>\r\n      <Toggle value={value} onToggle={onToggle} />\r\n      <span>{children}</span>\r\n    </FlexPair>\r\n  )\r\n}\r\n","import { TagType } from 'r34-types'\nimport React from 'react'\nimport {\n  CharacterIcon,\n  CopyrightIcon,\n  ArtistIcon,\n  RatingIcon,\n  SourceIcon,\n  MetaDataIcon,\n  SupertagIcon,\n} from './FontAwesomeIcons'\n\ninterface TypeIconProps {\n  type?: TagType\n  className?: string\n}\n\nexport default function TypeIcon(props: TypeIconProps) {\n  const { type, className = '' } = props\n\n  switch (type) {\n    case 'character':\n      return <CharacterIcon className={className} />\n    case 'copyright':\n      return <CopyrightIcon className={className} />\n    case 'artist':\n      return <ArtistIcon className={className} />\n    case 'rating':\n      return <RatingIcon className={className} />\n    case 'source':\n      return <SourceIcon className={className} />\n    case 'metadata':\n      return <MetaDataIcon className={className} />\n    case 'supertag':\n      return <SupertagIcon className={className} />\n    default:\n      return null\n  }\n}\n","import { css } from 'styled-components'\r\nimport { PropsWithTheme } from './types'\r\n\r\nexport function dropdownScrollbar({ theme }: PropsWithTheme) {\r\n  return css`\r\n    overflow-x: hidden;\r\n    overflow-y: auto;\r\n\r\n    ::-webkit-scrollbar {\r\n      width: 8px;\r\n\r\n      :hover {\r\n        background: ${theme.colors.layerBg};\r\n      }\r\n    }\r\n\r\n    /* Track */\r\n    ::-webkit-scrollbar-track {\r\n      background: ${theme.colors.backgroundColor2};\r\n      border-left: 1px lightgray solid;\r\n    }\r\n\r\n    /* Handle */\r\n    :hover {\r\n      ::-webkit-scrollbar {\r\n        background: ${theme.colors.backgroundColor}20;\r\n      }\r\n    }\r\n\r\n    ::-webkit-scrollbar-thumb {\r\n      background: ${theme.colors.backgroundColor}40;\r\n      border-radius: 100px;\r\n\r\n      :hover {\r\n        background: ${theme.colors.backgroundColor}30;\r\n      }\r\n    }\r\n  `\r\n}\r\n","import styled from 'styled-components'\r\nimport { defaultSpacing } from '../../styled/mixins/gap'\r\nimport { flexColumn } from '../../styled/mixins/layout'\r\n\r\nexport const FlexColumn = styled.div`\r\n  ${flexColumn}\r\n  width: 100%;\r\n  min-height: 100%;\r\n`\r\n\r\nexport const FlexColumnWithSpacing = styled(FlexColumn)`\r\n  ${defaultSpacing}\r\n`\r\n","import { Size } from 'react-virtualized'\r\nimport { css } from 'styled-components'\r\nimport { supportsAspectRatio } from '../../data/browserUtils'\r\nimport { borderRadius } from './theming'\r\n\r\n/**\r\n * Determines how media elements are displayed\r\n */\r\nexport function mediaStyle() {\r\n  return css`\r\n    ${borderRadius}\r\n  `\r\n}\r\n\r\n/**\r\n * Preserves aspect ratio of the element and ensures it is displayed as big as possible\r\n */\r\nexport function flexMedia() {\r\n  return css`\r\n    width: 100%;\r\n    height: 100%;\r\n    display: block;\r\n    object-fit: contain;\r\n  `\r\n}\r\n\r\n/**\r\n * Attempts to preserve aspect ration of an element.\r\n */\r\nexport function preserveAspectRatio({ width, height }: Partial<Size>) {\r\n  if (!width || !height) {\r\n    return ''\r\n  }\r\n\r\n  return supportsAspectRatio\r\n    ? css`\r\n        aspect-ratio: ${width} / ${height};\r\n      `\r\n    : css`\r\n        max-width: 100%;\r\n        height: auto;\r\n      `\r\n}\r\n","import React, { MouseEventHandler } from 'react'\r\nimport styled, { css, DefaultTheme } from 'styled-components'\r\nimport { supportsAspectRatio } from '../../data/browserUtils'\r\nimport { defaultBorder } from '../../styled/mixins/theming'\r\n\r\nconst Track = styled.div(\r\n  (props) => css`\r\n    height: 24px;\r\n    width: 50px;\r\n    ${defaultBorder(props)}\r\n    border-radius: 30px;\r\n    background-color: transparent;\r\n    transition: transform ${props.theme.timings.longTransitionTime} ease-in-out;\r\n    cursor: pointer;\r\n  `\r\n)\r\n\r\n/**\r\n * CSS helper that falls back to less fancy styling on older browsers\r\n */\r\nfunction circle() {\r\n  return supportsAspectRatio\r\n    ? css`\r\n        height: 100%;\r\n        aspect-ratio: 1/1;\r\n      `\r\n    : css`\r\n        height: 100%;\r\n        width: 22px;\r\n      `\r\n}\r\n\r\nconst Thumb = styled.div(\r\n  (props: { value: boolean; theme: DefaultTheme }) => css`\r\n    ${circle()}\r\n    background-color: ${props.value ? props.theme.colors.accentColor : props.theme.colors.toggleOff};\r\n    border-radius: 100px;\r\n    transition: all 0.2s ease-in-out;\r\n    transform: translate(${props.value ? '26px' : '0px'});\r\n  `\r\n)\r\n\r\ninterface ToggleProps {\r\n  value: boolean\r\n  onToggle: MouseEventHandler\r\n}\r\n\r\nexport default function Toggle(props: ToggleProps) {\r\n  const { value, onToggle } = props\r\n\r\n  return (\r\n    <Track onClick={onToggle} role='checkbox' aria-checked={value}>\r\n      <Thumb value={value} />\r\n    </Track>\r\n  )\r\n}\r\n","import firebase from 'firebase/app'\r\nimport 'firebase/auth'\r\nimport { useEffect, useState } from 'react'\r\nimport { useOnlineChange } from './useOnlineChange'\r\n\r\n/**\r\n * A hook that provides the firebase authentication status for use in functional components.\r\n */\r\nexport default function useFirebaseAuthState() {\r\n  const [authState, setAuthState] = useState(false)\r\n  const [user, setUser] = useState<firebase.User | null>(null)\r\n  const isOnline = useOnlineChange()\r\n\r\n  useEffect(() => {\r\n    if (isOnline) {\r\n      const unsubscribe = firebase.auth().onAuthStateChanged((user) => {\r\n        if (user) {\r\n          setAuthState(true)\r\n          setUser(user)\r\n        } else {\r\n          setAuthState(false)\r\n          setUser(null)\r\n        }\r\n      })\r\n      return () => {\r\n        unsubscribe()\r\n      }\r\n    }\r\n  }, [isOnline])\r\n\r\n  return [authState, user] as const\r\n}\r\n","import React from 'react'\r\nimport { useTheme } from 'styled-components'\r\nimport { useOnlineChange } from '../../hooks/useOnlineChange'\r\nimport { FailedIcon } from '../../icons/FontAwesomeIcons'\r\n\r\nexport default function OfflineIndicator() {\r\n  const theme = useTheme()\r\n  const isOnline = useOnlineChange()\r\n\r\n  return isOnline ? <div></div> : <FailedIcon title='You are offline' color={theme.colors.negative} />\r\n}\r\n","import { RefAttributes } from 'react'\r\nimport { Link, LinkProps, useLocation } from 'react-router-dom'\r\nimport styled, { css, ThemeProps } from 'styled-components'\r\nimport { RouteName } from '../../data/types'\r\nimport { buttonBaseStyle, flexRowWithGap } from '../../styled/mixins/layout'\r\n\r\nconst MenuBar = styled.nav`\r\n  ${flexRowWithGap}\r\n  place-content: center;\r\n`\r\n\r\ntype LocationStyledLinkProps = LinkProps<unknown> &\r\n  RefAttributes<HTMLAnchorElement> &\r\n  ThemeProps<any> & { current: string }\r\n\r\nconst LocationStyledLink = styled(Link)(\r\n  ({ to, current, theme }: LocationStyledLinkProps) => css`\r\n    ${buttonBaseStyle}\r\n    color: ${to === current ? theme.colors.accentColor : theme.colors.text};\r\n    border-bottom: solid transparent ${theme.dimensions.borderWidth};\r\n    border-bottom-color: ${to === current\r\n      ? css`\r\n          ${theme.colors.accentColor}\r\n        `\r\n      : 'none'};\r\n    border-radius: 0px;\r\n  `\r\n)\r\n\r\nexport default function Menu() {\r\n  const current = useLocation().pathname\r\n\r\n  return (\r\n    <MenuBar>\r\n      <LocationStyledLink current={current} to={RouteName.SEARCH}>\r\n        <span>Search</span>\r\n      </LocationStyledLink>\r\n\r\n      <LocationStyledLink current={current} to={RouteName.PREFERENCES}>\r\n        <span>Preferences</span>\r\n      </LocationStyledLink>\r\n\r\n      <LocationStyledLink current={current} to={RouteName.ABOUT}>\r\n        <span>About</span>\r\n      </LocationStyledLink>\r\n    </MenuBar>\r\n  )\r\n}\r\n","import styled, { css } from 'styled-components'\r\nimport R34Icon from '../../icons/R34Icon'\r\nimport { defaultSpacing } from '../../styled/mixins/gap'\r\nimport { flexColumn } from '../../styled/mixins/layout'\r\nimport FlexPair from '../designsystem/FlexPair'\r\nimport { BigTitle } from '../designsystem/Text'\r\nimport OfflineIndicator from '../widgets/OfflineIndicator'\r\nimport Menubar from '../widgets/Menubar'\r\nimport React from 'react'\r\n\r\nconst HeaderWrapper = styled.header(\r\n  ({ theme }) => css`\r\n    ${flexColumn}\r\n    background: ${theme.colors.layerBgSolid};\r\n  `\r\n)\r\n\r\nconst TitleBar = styled.div(\r\n  ({ theme }) => css`\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    ${defaultSpacing}\r\n\r\n    > :first-child,\r\n    > :last-child {\r\n      width: ${theme.dimensions.blockHeight};\r\n    }\r\n  `\r\n)\r\n\r\nexport default function Header() {\r\n  return (\r\n    <HeaderWrapper role='cell'>\r\n      <TitleBar>\r\n        <div>{/*placeholder*/}</div>\r\n        <FlexPair>\r\n          <R34Icon size={32} />\r\n          <BigTitle>Rule34 React</BigTitle>\r\n        </FlexPair>\r\n        <OfflineIndicator />\r\n      </TitleBar>\r\n      <Menubar />\r\n    </HeaderWrapper>\r\n  )\r\n}\r\n","import styled, { css } from 'styled-components'\r\nimport { TagModifier } from 'r34-types'\r\n\r\nconst modifierToStyle = {\r\n  '+': css``,\r\n  '-': css`\r\n    text-decoration: line-through;\r\n  `,\r\n  '~': css`\r\n    font-style: italic;\r\n  `,\r\n}\r\n\r\ninterface ModifierStyledTextProps {\r\n  modifier: TagModifier\r\n}\r\n\r\nexport const ModifierStyledText = styled.span(\r\n  ({ modifier = '+' }: ModifierStyledTextProps) => modifierToStyle[modifier]\r\n)\r\n","import { TagModifier } from 'r34-types'\r\nimport { formatTagnameAndCount } from '../../misc/formatting'\r\nimport { ModifierStyledText } from '../designsystem/ModifierStyledText'\r\n\r\ninterface TagNameProps {\r\n  modifier: TagModifier\r\n  name: string\r\n  count?: number\r\n}\r\n\r\nexport default function TagName(props: TagNameProps) {\r\n  const { modifier, name, count } = props\r\n\r\n  return <ModifierStyledText modifier={modifier}>{formatTagnameAndCount(name, count)}</ModifierStyledText>\r\n}\r\n","import React, { MouseEventHandler, useCallback } from 'react'\nimport { useDispatch } from 'react-redux'\nimport styled, { css } from 'styled-components'\nimport { TagModifier } from 'r34-types'\nimport { addTag } from '../../redux/actions'\nimport { flexRowWithGap } from '../../styled/mixins/layout'\nimport TagName from './TagName'\n\ninterface AliasProps {\n  modifier: TagModifier\n  name: string\n  count: number\n}\n\nconst AliasWrapper = styled.div(\n  ({ theme }) => css`\n    ${flexRowWithGap({ theme })}\n    padding: ${theme.dimensions.bigSpacing};\n    font-size: ${theme.fontSizes.content};\n    cursor: pointer;\n  `\n)\n\nexport default function Alias(props: AliasProps) {\n  const { name, count, modifier } = props\n\n  const dispatch = useDispatch()\n\n  const handleClick: MouseEventHandler = useCallback(\n    (event) => {\n      event.stopPropagation()\n      dispatch(addTag({ name, types: [], count, modifier }))\n    },\n    [count, dispatch, modifier, name]\n  )\n\n  return (\n    <AliasWrapper onClick={handleClick} data-name={`alias:${name}`}>\n      <TagName modifier={modifier} name={name} count={count} />\n    </AliasWrapper>\n  )\n}\n","import React from 'react'\r\nimport styled, { css, DefaultTheme } from 'styled-components'\r\nimport Alias from './Alias'\r\nimport * as r34 from 'r34-types'\r\nimport { dropdownScrollbar } from '../../styled/mixins/scrollbar'\r\nimport { ZIndex } from '../../styled/zIndex'\r\n\r\nconst ListWrapper = styled.div(({ theme, parentRef }: { theme: DefaultTheme; parentRef: HTMLDivElement }) => {\r\n  if (parentRef) {\r\n    const clientRect = parentRef.getBoundingClientRect()\r\n\r\n    return css`\r\n      position: absolute;\r\n      top: ${parentRef.offsetTop + clientRect.height}px;\r\n      left: ${parentRef.offsetLeft}px;\r\n      width: ${clientRect.width}px;\r\n\r\n      display: flex;\r\n      flex-direction: column;\r\n\r\n      border-bottom-left-radius: ${theme.dimensions.borderRadius};\r\n      border-bottom-right-radius: ${theme.dimensions.borderRadius};\r\n      border: ${theme.dimensions.borderWidth} solid ${theme.colors.accentColor};\r\n      border-top: none;\r\n\r\n      background: ${theme.colors.backgroundColor2};\r\n      z-index: ${ZIndex.DROPDOWN};\r\n      color: ${theme.colors.backgroundColor};\r\n\r\n      > :not(:last-child) {\r\n        border-bottom: ${theme.dimensions.borderWidth} solid lightgray;\r\n      }\r\n\r\n      max-height: 30vh;\r\n\r\n      ${dropdownScrollbar}\r\n    `\r\n  } else {\r\n    return css`\r\n      display: none;\r\n    `\r\n  }\r\n})\r\n\r\ninterface AliasesListProps {\r\n  aliases: r34.AliasTag[]\r\n  modifier: r34.TagModifier\r\n  parentRef: HTMLDivElement\r\n}\r\n\r\nexport default function AliasesList(props: AliasesListProps) {\r\n  const { aliases, modifier, parentRef } = props\r\n\r\n  return (\r\n    <ListWrapper parentRef={parentRef} className='aliaslist'>\r\n      {aliases.map(({ name, count }) => (\r\n        <Alias key={'a_' + name} name={name} count={count} modifier={modifier} />\r\n      ))}\r\n    </ListWrapper>\r\n  )\r\n}\r\n","import styled, { css, DefaultTheme } from 'styled-components'\r\nimport { TagIsActive } from '../../data/types'\r\nimport { flexRowWithGap } from '../../styled/mixins/layout'\r\nimport { primary, secondary, focus } from '../../styled/mixins/theming'\r\n\r\nconst dropdownBorderRadius = (collapsed: boolean, theme: DefaultTheme) =>\r\n  collapsed ? theme.dimensions.borderRadius : `${theme.dimensions.borderRadius} ${theme.dimensions.borderRadius} 0 0`\r\n\r\nconst switchingColors = (active: TagIsActive, collapsed: boolean, theme: DefaultTheme) => {\r\n  switch (active) {\r\n    case 'direct':\r\n      return css`\r\n        ${primary}\r\n      `\r\n    case 'indirect':\r\n      return css`\r\n        color: ${theme.colors.accentColor};\r\n        background-color: ${theme.colors.accentColor}40;\r\n\r\n        :hover {\r\n          background-color: ${theme.colors.accentColor}60;\r\n        }\r\n\r\n        :active {\r\n          background-color: ${theme.colors.accentColor}50;\r\n        }\r\n\r\n        ${focus}\r\n      `\r\n    case 'no':\r\n      return css`\r\n        ${secondary}\r\n      `\r\n  }\r\n}\r\n\r\nexport const ChipWrapper = styled.div(\r\n  (props: { active: TagIsActive; collapsed: boolean; theme: DefaultTheme }) =>\r\n    css`\r\n      cursor: pointer;\r\n      border: ${props.theme.colors.accentColor} ${props.theme.dimensions.borderWidth} solid;\r\n      ${flexRowWithGap({ theme: props.theme })}\r\n      ${switchingColors(props.active, props.collapsed, props.theme)}\r\n      padding: 0 ${props.theme.dimensions.bigSpacing};\r\n      height: ${props.theme.dimensions.blockHeight};\r\n      border-radius: ${dropdownBorderRadius(props.collapsed, props.theme)};\r\n      font-size: ${props.theme.fontSizes.content};\r\n      user-select: none;\r\n\r\n      ${props.collapsed\r\n        ? ''\r\n        : css`\r\n            border-bottom-color: ${props.theme.colors.accentColor};\r\n          `}\r\n    `\r\n)\r\n","import React, { KeyboardEventHandler, MouseEventHandler, SyntheticEvent, useCallback, useState } from 'react'\r\nimport styled, { DefaultTheme, css } from 'styled-components'\r\nimport { TagModifier, TagType, AliasTag } from 'r34-types'\r\nimport useToggle from '../../hooks/useToggle'\r\nimport { ArrowDown } from '../../icons/FontAwesomeIcons'\r\nimport TypeIcon from '../../icons/TypeIcon'\r\nimport AliasesList from './AliasesList'\r\nimport { ChipWrapper } from './ChipWrapper'\r\nimport TagName from './TagName'\r\nimport { TagIsActive } from '../../data/types'\r\n\r\nconst DropdownArrow = styled(ArrowDown)(\r\n  ({ $collapsed, theme }: { $collapsed: boolean; theme: DefaultTheme }) => css`\r\n    transition: all ${theme.timings.transitionTime} ease-out;\r\n    height: 32px;\r\n    width: 32px !important;\r\n    padding: 8px;\r\n    margin: 0 -8px;\r\n    ${$collapsed\r\n      ? css``\r\n      : css`\r\n          transform: rotate(180deg);\r\n        `}\r\n  `\r\n)\r\n\r\nconst DropdownWrapper = styled.div(\r\n  ({ theme }) => css`\r\n    .aliaslist {\r\n      border-color: ${theme.colors.backgroundColor2};\r\n    }\r\n  `\r\n)\r\n\r\ninterface TagChipProps {\r\n  name: string\r\n  modifier: TagModifier\r\n  count?: number\r\n  type?: TagType\r\n  isActive: TagIsActive\r\n  detailed: boolean\r\n  onClick: React.EventHandler<SyntheticEvent>\r\n  onContextMenu?: React.EventHandler<SyntheticEvent>\r\n  aliases?: AliasTag[]\r\n}\r\n\r\nexport default function TagChip(props: TagChipProps) {\r\n  const { name, count, modifier, type, isActive, detailed, onClick, onContextMenu, aliases } = props\r\n\r\n  const [tagRef, setTagRef] = useState<HTMLDivElement | null>(null)\r\n  const [collapsed, toggleCollapsed] = useToggle(true)\r\n\r\n  const handleClick = useCallback(\r\n    (event: React.MouseEvent | React.KeyboardEvent) => {\r\n      event.preventDefault()\r\n      event.stopPropagation()\r\n      onClick(event)\r\n    },\r\n    [onClick]\r\n  )\r\n\r\n  const handleArrowClick: MouseEventHandler = useCallback(\r\n    (event) => {\r\n      event.stopPropagation()\r\n      toggleCollapsed()\r\n    },\r\n    [toggleCollapsed]\r\n  )\r\n\r\n  const handleEnter: KeyboardEventHandler = useCallback(\r\n    (event) => {\r\n      if (event.key === 'Enter') handleClick(event)\r\n    },\r\n    [handleClick]\r\n  )\r\n\r\n  const handleContextMenu = React.useCallback(\r\n    (e) => {\r\n      e.stopPropagation()\r\n      e.preventDefault()\r\n      onContextMenu?.(e)\r\n    },\r\n    [onContextMenu]\r\n  )\r\n\r\n  return (\r\n    <DropdownWrapper>\r\n      <ChipWrapper\r\n        active={isActive}\r\n        collapsed={collapsed}\r\n        onClick={handleClick}\r\n        onKeyDown={handleEnter}\r\n        onContextMenu={handleContextMenu}\r\n        ref={setTagRef}\r\n        tabIndex={0}\r\n        role='listitem'\r\n      >\r\n        {detailed && <TypeIcon type={type} />}\r\n        <TagName modifier={modifier} name={name} count={count} />\r\n        {detailed && aliases && aliases.length > 0 && (\r\n          <DropdownArrow onClick={handleArrowClick} $collapsed={collapsed} title='Show aliases' />\r\n        )}\r\n      </ChipWrapper>\r\n      {detailed && aliases && aliases.length > 0 && !collapsed && tagRef && (\r\n        <AliasesList aliases={aliases} modifier={modifier} parentRef={tagRef} />\r\n      )}\r\n    </DropdownWrapper>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport * as r34 from 'r34-types'\r\nimport TagChip from './TagChip'\r\nimport { TagIsActive } from '../../data/types'\r\n\r\ninterface SupertagProps {\r\n  tag: r34.Supertag\r\n  isActive: TagIsActive\r\n  detailed: boolean\r\n  onClick: React.MouseEventHandler\r\n}\r\n\r\nexport default function Supertag(props: SupertagProps) {\r\n  const { tag, isActive, detailed, onClick } = props\r\n  const { name, tags } = tag\r\n\r\n  const count = Object.keys(tags).length\r\n\r\n  return (\r\n    <TagChip\r\n      name={name}\r\n      modifier='+'\r\n      type='supertag'\r\n      count={count}\r\n      isActive={isActive}\r\n      detailed={detailed}\r\n      onClick={onClick}\r\n    />\r\n  )\r\n}\r\n","import * as r34 from 'r34-types'\r\nimport TagChip from './TagChip'\r\nimport { getInterestingType } from '../../data/tagUtils'\r\nimport { TagIsActive } from '../../data/types'\r\nimport { useSelector } from 'react-redux'\r\nimport { selectAliases } from '../../redux/selectors'\r\n\r\ninterface TagProps {\r\n  tag: r34.BiasedTag\r\n  isActive: TagIsActive\r\n  detailed: boolean\r\n  onClick: React.MouseEventHandler\r\n  onContextMenu: React.MouseEventHandler\r\n}\r\n\r\nexport function BiasedTag(props: TagProps) {\r\n  const { tag, detailed, onClick, isActive, onContextMenu } = props\r\n  const { name, count, modifier, types } = tag\r\n\r\n  const aliases = useSelector(selectAliases)[name]\r\n\r\n  return (\r\n    <TagChip\r\n      name={name}\r\n      modifier={modifier}\r\n      type={getInterestingType(types)}\r\n      count={count}\r\n      isActive={isActive}\r\n      detailed={detailed}\r\n      onClick={onClick}\r\n      onContextMenu={onContextMenu}\r\n      aliases={aliases}\r\n    />\r\n  )\r\n}\r\n","import React, { MouseEventHandler, useCallback } from 'react'\r\nimport * as r34 from 'r34-types'\r\nimport { bias, isBiased, isSupertag } from '../../data/tagUtils'\r\nimport Supertag from './Supertag'\r\nimport { BiasedTag } from './BiasedTag'\r\nimport { TagIsActive } from '../../data/types'\r\n\r\ninterface TagProps {\r\n  tag: r34.AnyBiasedTag | r34.AnyTag\r\n  isActive: TagIsActive\r\n  detailed: boolean\r\n  onClick: (tag: r34.AnyBiasedTag) => void\r\n  onContextMenu: (tag: r34.AnyBiasedTag) => void\r\n}\r\n\r\nexport default function Tag(props: TagProps) {\r\n  const { tag, isActive, detailed, onClick, onContextMenu } = props\r\n\r\n  const biasedTag = isSupertag(tag) || isBiased(tag) ? tag : bias(tag, '+')\r\n\r\n  const handleClick: MouseEventHandler = useCallback(\r\n    (event) => {\r\n      event?.stopPropagation()\r\n      onClick(biasedTag)\r\n    },\r\n    [onClick, biasedTag]\r\n  )\r\n\r\n  const handleContextMenu: MouseEventHandler = useCallback(\r\n    (event) => {\r\n      onContextMenu(biasedTag)\r\n    },\r\n    [biasedTag, onContextMenu]\r\n  )\r\n\r\n  return isSupertag(biasedTag) ? (\r\n    <Supertag tag={biasedTag} isActive={isActive} detailed={detailed} onClick={handleClick} />\r\n  ) : (\r\n    <BiasedTag\r\n      tag={biasedTag}\r\n      isActive={isActive}\r\n      detailed={detailed}\r\n      onClick={handleClick}\r\n      onContextMenu={handleContextMenu}\r\n    />\r\n  )\r\n}\r\n","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport { AnyBiasedTag, AnyTag } from 'r34-types'\r\nimport { multilineList } from '../../styled/mixins/layout'\r\nimport Tag from './Tag'\r\nimport { TagIsActive } from '../../data/types'\r\n\r\nconst TagListWrapper = styled.div`\r\n  ${multilineList}\r\n`\r\n\r\ninterface TagListProps {\r\n  /**\r\n   * The entries of the list. Must be a map to avoid duplicates\r\n   */\r\n  tags: Record<string, AnyTag>\r\n  /**\r\n   * Passthrough classname for styling from outside\r\n   */\r\n  className?: string\r\n  /**\r\n   * Setting detailed to true displays a type for some tags and provides the ability to add aliases.\r\n   */\r\n  detailed: boolean\r\n  /**\r\n   * Children will be added at the end of the list. Here you can provide additional functionality or information\r\n   */\r\n  children?: React.ReactNode\r\n\r\n  onTagClick: (tag: AnyBiasedTag) => void\r\n  onTagMenu: (tag: AnyBiasedTag) => void\r\n  getIsActive?: (tag: AnyTag) => TagIsActive\r\n}\r\n\r\n/**\r\n * This component can be used to display multiple tags in a list of chips/badges.\r\n *\r\n */\r\nexport default function TagList(props: TagListProps) {\r\n  const { tags, className, detailed, children = null, onTagClick, getIsActive, onTagMenu } = props\r\n\r\n  return (\r\n    <TagListWrapper className={className} role='list'>\r\n      {Object.entries(tags).map(([key, tag]) => (\r\n        <Tag\r\n          key={key}\r\n          detailed={detailed}\r\n          tag={tag}\r\n          onClick={onTagClick}\r\n          onContextMenu={onTagMenu}\r\n          isActive={getIsActive?.(tag) || 'no'}\r\n        />\r\n      ))}\r\n      {children}\r\n    </TagListWrapper>\r\n  )\r\n}\r\n","import { css } from 'styled-components'\r\nimport { PropsWithTheme } from './types'\r\n\r\nexport function boxShadow({ theme }: PropsWithTheme) {\r\n  return css`\r\n    box-shadow: 0 1px ${theme.shadow.radius} ${theme.shadow.color};\r\n  `\r\n}\r\n\r\nexport function dropShadow({ theme }: PropsWithTheme) {\r\n  return css`\r\n    filter: drop-shadow(0 1px ${theme.shadow.radius} ${theme.shadow.color});\r\n  `\r\n}\r\n","import styled, { css } from 'styled-components'\r\n\r\nexport const HorizontalLine = styled.div(\r\n  (props) => css`\r\n    align-self: stretch;\r\n    height: 1px;\r\n    background: ${props.theme.colors.layerBgHighlight};\r\n  `\r\n)\r\n\r\nexport const VerticalLine = styled.div(\r\n  (props) => css`\r\n    width: 1px;\r\n    align-self: stretch;\r\n    background: ${props.theme.colors.layerBgHighlight};\r\n  `\r\n)\r\n","import { useCallback, useState } from 'react'\n\n/**\n * A small wrapper for a useState<boolean> that is primarily used for toggling.\n * Saves me a few useCallbacks.\n */\nexport default function useToggle(initialValue = false): [boolean, () => void, () => void] {\n  const [value, setValue] = useState<boolean>(initialValue)\n  const toggleValue = useCallback(() => setValue(!value), [value])\n  const resetValue = useCallback(() => setValue(initialValue), [initialValue])\n\n  return [value, toggleValue, resetValue]\n}\n","export async function sha256(message: string) {\r\n  const msgBuffer = new TextEncoder().encode(message)\r\n  const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer)\r\n  const hashArray = Array.from(new Uint8Array(hashBuffer))\r\n  const hashHex = hashArray.map((b) => b.toString(16).padStart(2, '0')).join('')\r\n\r\n  return hashHex\r\n}\r\n","import { useCallback } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { removeTag, addTag } from '../redux/actions'\r\nimport { selectActiveTags } from '../redux/selectors'\r\nimport * as r34 from 'r34-types'\r\n\r\n/**\r\n * This hook allows you to add a tag to your search or remove it based on its current status.\r\n */\r\nexport default function useToggleTag() {\r\n  const dispatch = useDispatch()\r\n  const activeTags = useSelector(selectActiveTags)\r\n  const toggleTag = useCallback(\r\n    (tag: r34.AnyBiasedTag) => {\r\n      if (tag.name in activeTags) {\r\n        dispatch(removeTag(tag.name))\r\n      } else {\r\n        dispatch(addTag(tag))\r\n      }\r\n    },\r\n    [activeTags, dispatch]\r\n  )\r\n\r\n  return toggleTag\r\n}\r\n","import React from 'react'\nimport * as r34 from 'r34-types'\nimport styled, { css } from 'styled-components'\nimport { CountUnit } from '../../data/types'\nimport TypeIcon from '../../icons/TypeIcon'\nimport { formatCount, formatTagname } from '../../misc/formatting'\n\nconst EntryWrapper = styled.div(\n  ({ theme }) => css`\n    display: grid;\n    grid-template-columns: 48px 1fr auto;\n    background: ${theme.colors.backgroundColor2};\n    padding: ${theme.dimensions.bigSpacing} 0;\n    align-items: center;\n    cursor: pointer;\n  `\n)\n\nconst Name = styled.span`\n  grid-column: 2/3;\n`\n\nconst Count = styled.span(\n  ({ theme }) => css`\n    grid-column: 3/4;\n    padding-right: ${theme.dimensions.bigSpacing};\n  `\n)\n\nconst Icon = styled.div`\n  grid-column: 1/2;\n  text-align: center;\n`\n\ninterface EntryProps {\n  name: string\n  count: number\n  type?: r34.TagType\n  onClick: React.MouseEventHandler\n}\n\nexport default function DropdownListEntry(props: EntryProps) {\n  const { name, count, type, onClick } = props\n\n  const unit: CountUnit = type === 'supertag' ? 'tags' : 'posts'\n\n  return (\n    <EntryWrapper onClick={onClick} role='listitem'>\n      <Icon>\n        <TypeIcon type={type} />\n      </Icon>\n      <Name>{formatTagname(name)}</Name>\n      <Count title={`${count} ${unit}`}>\n        {count && formatCount(count)} {unit}\n      </Count>\n    </EntryWrapper>\n  )\n}\n","import styled, { css } from 'styled-components'\r\nimport { flexRowWithGap } from '../../styled/mixins/layout'\r\n\r\nexport const DropdownListError = styled.div(\r\n  ({ theme }) => css`\r\n    ${flexRowWithGap}\r\n    flex-wrap: wrap;\r\n    min-height: ${theme.dimensions.blockHeight}; // COMPAT: Kiwi Browser\r\n    background: ${theme.colors.backgroundColor2};\r\n    padding: 6px;\r\n    align-items: center;\r\n    justify-content: center;\r\n    text-align: center;\r\n  `\r\n)\r\n","import React from 'react'\r\nimport styled, { css, DefaultTheme } from 'styled-components'\r\nimport DropdownListEntry from './DropdownListEntry'\r\nimport * as r34 from 'r34-types'\r\nimport { getInterestingType, isSupertag } from '../../data/tagUtils'\r\nimport { SuggestionsError } from '../../data/types'\r\nimport { DropdownListError } from './DropdownListError'\r\nimport { flexColumnGap } from '../../styled/mixins/gap'\r\nimport { flexColumn } from '../../styled/mixins/layout'\r\nimport { dropdownScrollbar } from '../../styled/mixins/scrollbar'\r\nimport { ZIndex } from '../../styled/zIndex'\r\n\r\nfunction sizeAndPosition(tagSelector: HTMLElement | null) {\r\n  if (tagSelector) {\r\n    const { offsetTop, clientHeight, offsetLeft, clientWidth } = tagSelector\r\n\r\n    return css`\r\n      position: absolute;\r\n      top: ${offsetTop + clientHeight}px;\r\n      left: ${offsetLeft}px;\r\n      width: ${clientWidth}px;\r\n      max-height: 50vh;\r\n    `\r\n  } else {\r\n    return css`\r\n      display: none;\r\n    `\r\n  }\r\n}\r\n\r\nconst ListWrapper = styled.div(\r\n  ({ theme, tagSelectorRef }: { tagSelectorRef: HTMLElement | null; theme: DefaultTheme }) => css`\r\n    ${flexColumn()}\r\n    ${flexColumnGap('1px')}\r\n    ${sizeAndPosition(tagSelectorRef)};\r\n    background: lightgrey;\r\n    box-sizing: border-box;\r\n    border: ${theme.dimensions.borderWidth} ${theme.colors.accentColor} solid;\r\n    border-top: none;\r\n    border-radius: 0 0 3px 3px;\r\n    color: black;\r\n    z-index: ${ZIndex.DROPDOWN};\r\n\r\n    ${dropdownScrollbar}\r\n  `\r\n)\r\n\r\ninterface DropdownListProps {\r\n  tagSelectorRef: HTMLElement | null\r\n  entries: r34.AnyTag[]\r\n  onClick: (entry: r34.AnyTag) => void\r\n  error: SuggestionsError | null\r\n}\r\n\r\nexport default function DropdownList(props: DropdownListProps) {\r\n  const { tagSelectorRef, entries, onClick, error } = props\r\n\r\n  return (\r\n    <ListWrapper tagSelectorRef={tagSelectorRef} role='list'>\r\n      {error ? (\r\n        <DropdownListError role='listitem'>\r\n          <span>{error.message}.</span>\r\n          <span>{error.results} tags found</span>\r\n        </DropdownListError>\r\n      ) : (\r\n        entries.map((entry) => {\r\n          const type = isSupertag(entry) ? 'supertag' : getInterestingType(entry.types)\r\n          const count = isSupertag(entry) ? Object.keys(entry.tags).length : (entry.count as number)\r\n\r\n          return (\r\n            <DropdownListEntry\r\n              key={entry.name}\r\n              onClick={() => onClick(entry)}\r\n              name={entry.name}\r\n              type={type}\r\n              count={count}\r\n            />\r\n          )\r\n        })\r\n      )}\r\n    </ListWrapper>\r\n  )\r\n}\r\n","import React, { ChangeEventHandler, KeyboardEventHandler, useCallback } from 'react'\nimport styled, { css } from 'styled-components'\n\nconst Input = styled.input(\n  (props) => css`\n    width: 100%;\n    border: none;\n    outline: none;\n    background: none;\n    font-size: ${props.theme.fontSizes.content};\n    border-top: ${props.theme.colors.accentColor} ${props.theme.dimensions.borderWidth} solid;\n    border-bottom: ${props.theme.colors.accentColor} ${props.theme.dimensions.borderWidth} solid;\n  `\n)\n\ninterface TagInputProps {\n  value: string\n  setValue: (newValue: string) => void\n  onSubmit: () => void\n}\n\nexport default function TagInput(props: TagInputProps) {\n  const { value, setValue, onSubmit } = props\n\n  const handleChange: ChangeEventHandler<HTMLInputElement> = useCallback(\n    (event) => {\n      setValue(event.target.value)\n    },\n    [setValue]\n  )\n\n  const handleEnter: KeyboardEventHandler = useCallback(\n    (event: React.KeyboardEvent) => {\n      if (event.key === 'Enter') {\n        onSubmit()\n      }\n    },\n    [onSubmit]\n  )\n\n  return (\n    <Input\n      id='tag-input'\n      value={value}\n      onChange={handleChange}\n      onKeyDown={handleEnter}\n      placeholder='Search for tags'\n      aria-label='Search'\n    />\n  )\n}\n","import React from 'react'\r\nimport * as r34 from 'r34-types'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport styled, { css, DefaultTheme } from 'styled-components'\r\nimport useThrottledEffect from 'use-throttled-effect'\r\nimport { bias, isSupertag, serializeTagname } from '../../data/tagUtils'\r\nimport useModifier from '../../hooks/useModifier'\r\nimport { SubmitIcon } from '../../icons/FontAwesomeIcons'\r\nimport { fetchSuggestions, setSuggestions } from '../../redux/actions'\r\nimport { selectSuggestions, selectSuggestionsError } from '../../redux/selectors'\r\nimport { AddButton, ModifierButton } from '../designsystem/Buttons'\r\nimport DropdownList from './DropdownList'\r\nimport TagInput from './TagInput'\r\n\r\nconst TagSelectorWrapper = styled.form(\r\n  (props: { closed: boolean; ref: (ref: HTMLInputElement) => void; theme: DefaultTheme }) => css`\r\n    display: flex;\r\n    background: white;\r\n    ${props.closed\r\n      ? css`\r\n          border-radius: ${props.theme.dimensions.borderRadius};\r\n        `\r\n      : css`\r\n          border-radius: ${props.theme.dimensions.borderRadius} ${props.theme.dimensions.borderRadius} 0 0;\r\n\r\n          > ${AddButton} {\r\n            border-radius: 0 ${props.theme.dimensions.borderRadius} 0 0;\r\n          }\r\n\r\n          > ${ModifierButton} {\r\n            border-radius: ${props.theme.dimensions.borderRadius} 0 0 0;\r\n          }\r\n        `}\r\n  `\r\n)\r\n\r\ninterface TagSelectorProps {\r\n  showSupertags: boolean\r\n  onSubmit: (tag: r34.AnyBiasedTag) => void\r\n}\r\n\r\nexport default function TagSelector(props: TagSelectorProps) {\r\n  const { onSubmit, showSupertags } = props\r\n\r\n  const dispatch = useDispatch()\r\n\r\n  const [value, setValue] = React.useState('')\r\n  const [tagSelectorRef, setTagSelectorRef] = React.useState<HTMLElement | null>(null)\r\n  const [modifier, nextModifier] = useModifier()\r\n\r\n  const suggestions = useSelector(selectSuggestions)\r\n  const error = useSelector(selectSuggestionsError)\r\n\r\n  const activateTag = React.useCallback(\r\n    (tag: r34.Tag | r34.Supertag) => {\r\n      const biasedTag = isSupertag(tag) ? tag : bias(tag, modifier)\r\n      onSubmit(biasedTag)\r\n      setValue('')\r\n    },\r\n    [modifier, onSubmit]\r\n  )\r\n\r\n  // This effect updates suggestions based on the input value\r\n  // if the value is empty, it clears suggestions\r\n  // if the value is not empty, it fetches suggestions from the backend\r\n  useThrottledEffect(\r\n    () => {\r\n      if (value === '') {\r\n        if (suggestions.length > 0) {\r\n          dispatch(setSuggestions([]))\r\n        }\r\n      } else {\r\n        dispatch(fetchSuggestions(value, showSupertags))\r\n      }\r\n    },\r\n    300,\r\n    [value]\r\n  )\r\n\r\n  const handleAddClick = React.useCallback(() => {\r\n    if (value.trim()) {\r\n      const sanitizedTagname = serializeTagname(value)\r\n      const suggestion: r34.AnyTag | undefined = suggestions.find((s) => s.name === sanitizedTagname)\r\n\r\n      if (suggestion) {\r\n        activateTag(suggestion)\r\n      } else {\r\n        activateTag({ name: sanitizedTagname, types: [] })\r\n      }\r\n    }\r\n  }, [value, activateTag, suggestions])\r\n\r\n  const showList = suggestions.length > 0 || error !== null\r\n\r\n  const preventDefault = React.useCallback((e) => e.preventDefault(), [])\r\n\r\n  return (\r\n    <TagSelectorWrapper ref={setTagSelectorRef} closed={!showList} onSubmit={preventDefault}>\r\n      <ModifierButton onClick={nextModifier} aria-label='Tag Modifier' title='Cycle tag modifier'>\r\n        {modifier}\r\n      </ModifierButton>\r\n      <TagInput value={value} setValue={setValue} onSubmit={handleAddClick} />\r\n      <AddButton onClick={handleAddClick} aria-label='Add Tag'>\r\n        <SubmitIcon title='Add tag' />\r\n      </AddButton>\r\n      {showList && value.length > 0 && (\r\n        <DropdownList tagSelectorRef={tagSelectorRef} entries={suggestions} error={error} onClick={activateTag} />\r\n      )}\r\n    </TagSelectorWrapper>\r\n  )\r\n}\r\n","import React, { useCallback } from 'react'\r\nimport { signOut } from '../../firebase'\r\nimport { UndoIcon } from '../../icons/FontAwesomeIcons'\r\nimport { BlockButton } from '../designsystem/Buttons'\r\n\r\nexport default function ResetButton(props: any) {\r\n  const reset = useCallback(async () => {\r\n    // localStorage can be disabled in browser settings\r\n    localStorage?.clear()\r\n\r\n    await signOut()\r\n\r\n    window.location.hash = ''\r\n    window.location.reload()\r\n  }, [])\r\n\r\n  return (\r\n    <BlockButton onClick={reset} {...props}>\r\n      <UndoIcon /> Reset Application\r\n    </BlockButton>\r\n  )\r\n}\r\n","export default __webpack_public_path__ + \"static/media/OutOfResults.9c71691c.png\";","import React from 'react'\nimport styled from 'styled-components'\n\n// Don't use theme here so the loadingScreen is independent\n// eg. Loading the theme displays this loading screen\nconst StyledSvg = styled.svg`\n  height: 32px;\n  padding: 8px;\n  color: white;\n`\n\nexport default function Loading() {\n  return (\n    <StyledSvg\n      xmlns='http://www.w3.org/2000/svg'\n      xmlnsXlink='http://www.w3.org/1999/xlink'\n      viewBox='0 0 50 20'\n      enable-background='new 0 0 0 0'\n      xmlSpace='preserve'\n    >\n      <circle fill='currentcolor' stroke='none' cx='6' cy='10' r='6'>\n        <animate attributeName='opacity' dur='1s' values='0;1;0' repeatCount='indefinite' begin='0.1' />\n      </circle>\n      <circle fill='currentcolor' stroke='none' cx='25' cy='10' r='6'>\n        <animate attributeName='opacity' dur='1s' values='0;1;0' repeatCount='indefinite' begin='0.2' />\n      </circle>\n      <circle fill='currentcolor' stroke='none' cx='44' cy='10' r='6'>\n        <animate attributeName='opacity' dur='1s' values='0;1;0' repeatCount='indefinite' begin='0.3' />\n      </circle>\n    </StyledSvg>\n  )\n}\n","import { useTheme } from 'styled-components'\n\nexport default function R34Icon(props: { size: number; className?: string }) {\n  const theme = useTheme()\n\n  return (\n    <svg\n      xmlns='http://www.w3.org/2000/svg'\n      width={props.size}\n      height={props.size}\n      viewBox='0 0 12.7 12.7'\n      className={props.className}\n    >\n      <g transform='translate(0,-284.3)'>\n        <circle\n          id='path18'\n          cx='6.3499999'\n          cy='290.65002'\n          fill='none'\n          stroke={theme.colors.accentColor}\n          strokeWidth='0.50848764'\n          strokeMiterlimit='4'\n          strokeDasharray='none'\n          strokeOpacity='1'\n          r='6.0957561'\n        />\n        <text\n          fontStyle='normal'\n          fontWeight='normal'\n          fontSize='8.3113203px'\n          fontFamily='sansSerif'\n          letterSpacing='0px'\n          wordSpacing='0px'\n          fill={theme.colors.accentColor}\n          fillOpacity='1'\n          x='2.1363549'\n          y='289.02704'\n          id='text4533'\n          transform='scale(0.98538224,1.0148346)'\n        >\n          <tspan\n            id='tspan4531'\n            x='2'\n            y='289.1'\n            fontStyle='normal'\n            fontVariant='normal'\n            fontWeight='300'\n            fontStretch='normal'\n            fontFamily='Calibri'\n            fill={theme.colors.accentColor}\n            fillOpacity='1'\n          >\n            34\n          </tspan>\n        </text>\n      </g>\n    </svg>\n  )\n}\n","import { useCallback } from 'react'\nimport { TagModifier } from 'r34-types'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { selectSuggestionsModifier } from '../redux/selectors'\nimport { setSuggestionsModifier } from '../redux/actions'\n\nconst order: TagModifier[] = ['+', '-', '~']\n\n/**\n * Small utility hook to abstract the rotating modifier away\n */\nexport default function useModifier() {\n  const dispatch = useDispatch()\n  const modifier = useSelector(selectSuggestionsModifier)\n  const nextModifier = useCallback(\n    () => dispatch(setSuggestionsModifier(order[(order.indexOf(modifier) + 1) % order.length])),\n    [dispatch, modifier]\n  )\n\n  return [modifier, nextModifier] as const\n}\n","import React, { useCallback, useEffect } from 'react'\r\nimport * as r34 from 'r34-types'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { isSupertag } from '../../data/tagUtils'\r\nimport { ModalId, NO_OP } from '../../data/types'\r\nimport { useCheckIsActive } from '../../hooks/useCheckIsActive'\r\nimport useToggleTag from '../../hooks/useToggleTag'\r\nimport { SupertagIcon } from '../../icons/FontAwesomeIcons'\r\nimport { addTag, openModal } from '../../redux/actions'\r\nimport { selectActiveTags, selectNumberOfActiveTags } from '../../redux/selectors'\r\nimport { PrimaryButton } from '../designsystem/Buttons'\r\nimport TagList from '../tag/TagList'\r\n\r\ninterface ActiveTagsProps {\r\n  onChange?: () => void\r\n  offerSupertags?: boolean\r\n}\r\n\r\nexport default function ActiveTags(props: ActiveTagsProps) {\r\n  const { onChange = NO_OP, offerSupertags = false } = props\r\n\r\n  const dispatch = useDispatch()\r\n\r\n  const activeTags = useSelector(selectActiveTags)\r\n  const numberOfActiveTags = useSelector(selectNumberOfActiveTags)\r\n  const openSupertagModal = useCallback(() => dispatch(openModal(ModalId.CREATE_SUPERTAG)), [dispatch])\r\n\r\n  const toggleTag = useToggleTag()\r\n  const checkIsActive = useCheckIsActive()\r\n\r\n  const onTagMenu = React.useCallback(\r\n    (tag: r34.AnyBiasedTag) => {\r\n      if (!isSupertag(tag)) {\r\n        const order: r34.TagModifier[] = ['+', '-', '~']\r\n        const nextModifer = order[(order.indexOf(tag.modifier) + 1) % 3]\r\n        dispatch(addTag({ ...tag, modifier: nextModifer }))\r\n      }\r\n    },\r\n    [dispatch]\r\n  )\r\n\r\n  // Fire change event when tags change\r\n  // This is used to re-measure the height\r\n  useEffect(() => onChange(), [onChange, activeTags])\r\n\r\n  return numberOfActiveTags > 0 ? (\r\n    <TagList tags={activeTags} onTagClick={toggleTag} getIsActive={checkIsActive} onTagMenu={onTagMenu} detailed>\r\n      {offerSupertags && Object.keys(activeTags).length > 1 && (\r\n        <PrimaryButton onClick={openSupertagModal} title='Create a supertag'>\r\n          <SupertagIcon />\r\n        </PrimaryButton>\r\n      )}\r\n    </TagList>\r\n  ) : null\r\n}\r\n","import { useCallback } from 'react'\r\nimport { useSelector } from 'react-redux'\r\nimport { AnyTag } from 'r34-types'\r\nimport { TagIsActive } from '../data/types'\r\nimport { selectActiveSupertagTags, selectActiveTags } from '../redux/selectors'\r\n\r\nexport const useCheckIsActive = () => {\r\n  const activeTags = useSelector(selectActiveTags)\r\n  const activeSupertagsTags = useSelector(selectActiveSupertagTags)\r\n\r\n  return useCallback(\r\n    (tag: AnyTag): TagIsActive => {\r\n      if (tag.name in activeTags) return 'direct'\r\n      if (tag.name in activeSupertagsTags) return 'indirect'\r\n      else return 'no'\r\n    },\r\n    [activeSupertagsTags, activeTags]\r\n  )\r\n}\r\n","import * as r34 from 'r34-types'\r\nimport { useCallback } from 'react'\r\nimport { useDispatch } from 'react-redux'\r\nimport { addTag } from '../redux/actions'\r\n\r\nexport const useActivateTag = () => {\r\n  const dispatch = useDispatch()\r\n\r\n  return useCallback(\r\n    (tag: r34.AnyBiasedTag) => {\r\n      dispatch(addTag(tag))\r\n    },\r\n    [dispatch]\r\n  )\r\n}\r\n","import React, { ReactNode } from 'react'\r\n\r\ninterface ErrorBoundaryProps {\r\n  fallback: ReactNode\r\n  children: ReactNode\r\n}\r\n\r\ninterface ErrorBoundaryState {\r\n  hasError: boolean\r\n}\r\n\r\nexport default class ErrorBoundary extends React.Component<ErrorBoundaryProps, ErrorBoundaryState> {\r\n  constructor(props: ErrorBoundaryProps) {\r\n    super(props)\r\n    this.state = { hasError: false }\r\n  }\r\n\r\n  static getDerivedStateFromError(error: Error) {\r\n    return { hasError: true }\r\n  }\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      return this.props.fallback\r\n    }\r\n\r\n    return this.props.children\r\n  }\r\n}\r\n","import React from 'react'\r\nimport { RouteName } from '../../data/types'\r\n\r\nconst keybinds: Record<string, () => void> = {\r\n  '/': () => document.getElementById('tag-input')?.focus(),\r\n  'ctrl+1': () => (window.location.hash = `#${RouteName.SEARCH}`),\r\n  'ctrl+2': () => (window.location.hash = `#${RouteName.PREFERENCES}`),\r\n  'ctrl+3': () => (window.location.hash = `#${RouteName.ABOUT}`),\r\n}\r\n\r\nexport default function GlobalKeybindings() {\r\n  React.useEffect(() => {\r\n    const handler = (event: KeyboardEvent) => {\r\n      const pressed = `${event.ctrlKey ? 'ctrl+' : ''}${event.key}`\r\n\r\n      if (pressed in keybinds) {\r\n        event.preventDefault()\r\n        event.stopPropagation()\r\n        keybinds[pressed]()\r\n      }\r\n    }\r\n    document.addEventListener('keydown', handler)\r\n    return () => document.removeEventListener('keydown', handler)\r\n  })\r\n\r\n  return null\r\n}\r\n","import { createGlobalStyle, css } from 'styled-components'\n\nexport default createGlobalStyle(\n  ({ theme }) => css`\n    p,\n    a,\n    button,\n    span,\n    div,\n    select,\n    input {\n      font-family: 'Raleway', sans-serif;\n      -webkit-font-smoothing: antialiased;\n      -moz-osx-font-smoothing: grayscale;\n      font-size: ${theme.fontSizes.content};\n    }\n\n    html {\n      background-color: ${theme.colors.backgroundColor};\n    }\n\n    body {\n      font-size: ${theme.fontSizes.content};\n      color: ${theme.colors.text};\n      background-color: ${theme.colors.backgroundColor};\n      transition: color 0.4s, background-color 0.4s;\n\n      // always show scrollbar to prevent layout shifts when changing pages\n      overflow-y: scroll;\n    }\n\n    a {\n      color: ${theme.colors.accentColor};\n      text-decoration: none;\n    }\n\n    // Not a touch device\n    // Touch devices have nice scrollbars by default\n    @media (pointer: fine) {\n      // Underline stuff that is focused on non-touch devices\n      // makes keyboard navigation clearer\n      button,\n      input,\n      select {\n        &:focus {\n          text-decoration: underline;\n        }\n      }\n\n      ::-webkit-scrollbar {\n        height: 8px;\n        transition: all ${theme.timings.transitionTime} ease-in-out;\n\n        :hover {\n          background: ${theme.colors.layerBg};\n        }\n      }\n\n      /* Track */\n      ::-webkit-scrollbar-track {\n        background: transparent;\n      }\n\n      /* Handle */\n      :hover {\n        ::-webkit-scrollbar {\n          background: ${theme.colors.layerBg};\n        }\n      }\n\n      ::-webkit-scrollbar-thumb {\n        background: ${theme.colors.layerBg};\n        border-radius: 1000px;\n\n        :hover {\n          background: ${theme.colors.layerBgHighlight};\n        }\n      }\n    }\n  `\n)\n","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport ResetButton from '../widgets/ResetButton'\r\nimport outOfResultsPicture from '../../icons/OutOfResults.png'\r\nimport FlexImage from '../designsystem/FlexImage'\r\nimport { themes, defaultThemeId } from 'r34-branding'\r\nimport GlobalStyles from '../../GlobalStyles'\r\n\r\nconst FullScreenCentered = styled.div`\r\n  height: 100vh;\r\n  width: 100%;\r\n  display: grid;\r\n  place-items: center;\r\n  align-content: center;\r\n  padding: 30px;\r\n  background: ${({ theme }) => theme.colors.backgroundColor};\r\n\r\n  > * {\r\n    margin-bottom: 10px;\r\n  }\r\n`\r\n\r\nexport default function ErrorScreen() {\r\n  const theme = themes[defaultThemeId]\r\n\r\n  return (\r\n    <FullScreenCentered theme={theme}>\r\n      <GlobalStyles theme={theme} />\r\n      <FlexImage src={outOfResultsPicture} alt='Shironeko does not understand' />\r\n      <h1>Sorry about that...</h1>\r\n      <ResetButton theme={theme} />\r\n    </FullScreenCentered>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport Loading from '../../icons/Loading'\r\n\r\nconst FullScreenCentered = styled.div`\r\n  height: 100vh;\r\n  width: 100vw;\r\n  display: grid;\r\n  place-items: center;\r\n  background: black;\r\n`\r\n\r\nexport default function LoadingScreen() {\r\n  return (\r\n    <FullScreenCentered>\r\n      <Loading />\r\n    </FullScreenCentered>\r\n  )\r\n}\r\n","import styled, { css } from 'styled-components'\r\nimport { DiscordIcon } from '../../icons/FontAwesomeIcons'\r\nimport { gap } from '../../styled/mixins/gap'\r\nimport { LinkButton } from '../designsystem/Buttons'\r\nimport { FlexColumn, FlexColumnWithSpacing } from '../designsystem/FlexColumn'\r\nimport { Surface } from '../designsystem/Surface'\r\nimport { Faded, Title } from '../designsystem/Text'\r\nimport Header from '../features/Header'\r\n\r\nconst SectionBody = styled(Surface)(\r\n  ({ theme }) => css`\r\n    padding: ${theme.dimensions.hugeSpacing};\r\n    ${gap(theme.dimensions.hugeSpacing)};\r\n  `\r\n)\r\n\r\nconst Section = styled(FlexColumnWithSpacing)`\r\n  flex-grow: 1;\r\n`\r\n\r\nexport default function Terms() {\r\n  document.title = 'Rule34 React - Terms of Service'\r\n\r\n  return (\r\n    <FlexColumn>\r\n      <Header />\r\n      <Section>\r\n        <Title>Terms of Service</Title>\r\n        <SectionBody>\r\n          <p>\r\n            Because this website is basically just a really powerful looking glass, I do not impose any additional terms\r\n            or conditions on you.\r\n          </p>\r\n          <p>\r\n            However, terms for the technologies this app uses still apply. Therefore, you should read the following\r\n            terms.\r\n          </p>\r\n          <a href='https://policies.google.com/terms'>Google - Privacy & Terms</a>\r\n          <a href='https://rule34.xxx/tos.php'>Rule34 - Terms of Serivce</a>\r\n          <Faded>If you have any questions feel free to contact me via Discord</Faded>\r\n          <LinkButton href=' https://discord.gg/yyJFG5PVBZ'>\r\n            <DiscordIcon />\r\n            Discord\r\n          </LinkButton>\r\n        </SectionBody>\r\n      </Section>\r\n    </FlexColumn>\r\n  )\r\n}\r\n","import React, { useCallback } from 'react'\r\nimport styled, { css } from 'styled-components'\r\nimport useAction from '../../hooks/useAction'\r\nimport { closeModal } from '../../redux/actions'\r\nimport { flexColumnWithGap, fullscreenOverlay } from '../../styled/mixins/layout'\r\nimport { ZIndex } from '../../styled/zIndex'\r\nimport { SolidSurface } from './Surface'\r\n\r\nconst Wrapper = styled.div(\r\n  ({ theme }) => css`\r\n    display: grid;\r\n    place-items: center;\r\n    ${fullscreenOverlay}\r\n    z-index: ${ZIndex.MODAL};\r\n    padding: ${theme.dimensions.hugeSpacing};\r\n    background: ${theme.colors.backdrop};\r\n  `\r\n)\r\n\r\nconst ModalSurface = styled(SolidSurface)(\r\n  ({ theme }) => css`\r\n    ${flexColumnWithGap}\r\n    max-width: ${theme.dimensions.modalWidth};\r\n    max-height: 100vh;\r\n    overflow-y: auto;\r\n    overscroll-behavior: none;\r\n  `\r\n)\r\n\r\ninterface ModalProps {\r\n  children: React.ReactNode\r\n}\r\n\r\nexport default function Modal(props: ModalProps) {\r\n  const { children } = props\r\n\r\n  const close = useAction(closeModal)\r\n  const blockEvent = useCallback((e) => e.stopPropagation(), [])\r\n\r\n  return (\r\n    <Wrapper onClick={close} title='Close modal'>\r\n      <ModalSurface onClick={blockEvent} title=''>\r\n        {children}\r\n      </ModalSurface>\r\n    </Wrapper>\r\n  )\r\n}\r\n","export default __webpack_public_path__ + \"static/media/eeek.ff41d889.png\";","import React, { useCallback } from 'react'\r\nimport useAction from '../../hooks/useAction'\r\nimport { closeModal, getResults } from '../../redux/actions'\r\nimport Modal from '../designsystem/Modal'\r\nimport eeek from '../../icons/eeek.png'\r\nimport FlexImage from '../designsystem/FlexImage'\r\nimport { Faded, Title } from '../designsystem/Text'\r\nimport { flexRowWithGap } from '../../styled/mixins/layout'\r\nimport { PrimaryButton } from '../designsystem/Buttons'\r\nimport styled from 'styled-components'\r\nimport { FailedIcon, SuccessIcon } from '../../icons/FontAwesomeIcons'\r\nimport LabeledToggle from '../designsystem/LabeledToggle'\r\nimport usePreference from '../../hooks/usePreference'\r\n\r\nconst ButtonRow = styled.div`\r\n  ${flexRowWithGap}\r\n\r\n  > ${PrimaryButton} {\r\n    flex-grow: 1;\r\n  }\r\n`\r\n\r\nexport default function CellularWarningModal() {\r\n  const close = useAction(closeModal)\r\n  const search = useAction(getResults)\r\n\r\n  const onConfirm = useCallback(() => {\r\n    search()\r\n    close()\r\n  }, [close, search])\r\n\r\n  const onCancel = useCallback(() => {\r\n    close()\r\n  }, [close])\r\n\r\n  const [autoPlay, setAutoPlay] = usePreference('autoPlay')\r\n  const toggleAutoPlay = useCallback(() => setAutoPlay(!autoPlay), [autoPlay, setAutoPlay])\r\n  const [preloadVideos, setPreloadVideos] = usePreference('preloadVideos')\r\n  const togglePreloadVideos = useCallback(() => setPreloadVideos(!preloadVideos), [preloadVideos, setPreloadVideos])\r\n  const [originals, setOriginals] = usePreference('originals')\r\n  const toggleOriginals = useCallback(() => setOriginals(!originals), [originals, setOriginals])\r\n\r\n  return (\r\n    <Modal>\r\n      <FlexImage src={eeek} />\r\n      <Title>Wait!</Title>\r\n      <Faded>\r\n        You are on cellular and have some features enabled that will consume a lot of data. Are you sure this is\r\n        intended?\r\n      </Faded>\r\n      <LabeledToggle value={autoPlay} onToggle={toggleAutoPlay}>\r\n        Auto-play Animations\r\n      </LabeledToggle>\r\n      <LabeledToggle value={preloadVideos} onToggle={togglePreloadVideos}>\r\n        Preload Animations\r\n      </LabeledToggle>\r\n      <LabeledToggle value={originals} onToggle={toggleOriginals}>\r\n        Load original sizes\r\n      </LabeledToggle>\r\n      <ButtonRow>\r\n        <PrimaryButton onClick={onConfirm}>\r\n          <SuccessIcon /> Yes\r\n        </PrimaryButton>\r\n        <PrimaryButton onClick={onCancel}>\r\n          <FailedIcon /> No\r\n        </PrimaryButton>\r\n      </ButtonRow>\r\n    </Modal>\r\n  )\r\n}\r\n","import React, { useCallback } from 'react'\r\nimport styled, { css } from 'styled-components'\r\nimport { PrimaryButton } from '../designsystem/Buttons'\r\nimport usePreference from '../../hooks/usePreference'\r\nimport { ZIndex } from '../../styled/zIndex'\r\nimport { SolidSurface } from '../designsystem/Surface'\r\n\r\nconst CookieWrapper = styled(SolidSurface)(\r\n  ({ theme }) => css`\r\n    position: sticky;\r\n    bottom: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    color: ${theme.colors.text};\r\n    background: ${theme.colors.layerBgSolid};\r\n    z-index: ${ZIndex.COOKIEBAR};\r\n  `\r\n)\r\n\r\nconst StyledSpan = styled.span`\r\n  height: min-content;\r\n`\r\n\r\nexport default function CookieConfirmation() {\r\n  const [, setCookies] = usePreference('cookies')\r\n\r\n  const handleAccept = useCallback(() => setCookies(true), [setCookies])\r\n\r\n  return (\r\n    <CookieWrapper>\r\n      <StyledSpan>This website uses cookies.</StyledSpan>\r\n      <PrimaryButton onClick={handleAccept} aria-label='Allow Cookies' title='Accept Cookie usage'>\r\n        Okay\r\n      </PrimaryButton>\r\n    </CookieWrapper>\r\n  )\r\n}\r\n","import React, { useCallback, useState } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport styled, { css } from 'styled-components'\r\nimport { addSupertag } from '../../firebase'\r\nimport { selectActiveTags } from '../../redux/selectors'\r\nimport { defaultBorder } from '../../styled/mixins/theming'\r\nimport { BlockButton } from '../designsystem/Buttons'\r\nimport { HorizontalLine } from '../designsystem/Lines'\r\nimport { Title } from '../designsystem/Text'\r\nimport TagSelector from '../tagSelector/TagSelector'\r\nimport ActiveTags from './ActiveTags'\r\nimport * as r34 from 'r34-types'\r\nimport { isSupertag } from '../../data/tagUtils'\r\nimport { useActivateTag } from '../../hooks/useActivateTag'\r\nimport { closeModal, removeTag } from '../../redux/actions'\r\nimport useAction from '../../hooks/useAction'\r\nimport Modal from '../designsystem/Modal'\r\nimport { defaultBlock } from '../../styled/mixins/layout'\r\n\r\nconst StyledInput = styled.input(\r\n  ({ theme }) => css`\r\n    ${defaultBorder}\r\n    background-color: ${theme.colors.backgroundColor2};\r\n    ${defaultBlock}\r\n    text-align: left;\r\n  `\r\n)\r\n\r\nexport default function SupertagModal() {\r\n  const [name, setName] = useState('')\r\n  const [description, setDescription] = useState('')\r\n  const activeTags = useSelector(selectActiveTags)\r\n  const dispatch = useDispatch()\r\n  const activateTag = useActivateTag()\r\n  const close = useAction(closeModal)\r\n\r\n  const tags: Record<string, r34.TagModifier> = Object.values(activeTags)\r\n    .filter((tag): tag is r34.BiasedTag => !isSupertag(tag))\r\n    .reduce((result, tag) => ({ ...result, [tag.name]: tag.modifier }), {})\r\n\r\n  const handleCreate = useCallback(() => {\r\n    addSupertag(name, description, tags)\r\n      .then(() => {\r\n        Object.keys(tags).forEach((tagname) => dispatch(removeTag(tagname)))\r\n        activateTag({ name, description, tags })\r\n        close()\r\n      })\r\n      .catch((err) => console.error('Failed to create supertag', err))\r\n  }, [activateTag, close, description, dispatch, name, tags])\r\n\r\n  return (\r\n    <Modal>\r\n      <Title>Create Supertag</Title>\r\n      <HorizontalLine />\r\n      <StyledInput type='text' placeholder='Name' value={name} onChange={(e) => setName(e.target.value)} />\r\n      <StyledInput\r\n        type='text'\r\n        placeholder='Description'\r\n        value={description}\r\n        onChange={(e) => setDescription(e.target.value)}\r\n      />\r\n      <TagSelector showSupertags={false} onSubmit={activateTag} />\r\n      <ActiveTags />\r\n      <BlockButton onClick={handleCreate}>Create</BlockButton>\r\n    </Modal>\r\n  )\r\n}\r\n","enum AnalyticsEventId {\n  SEARCH = 'r34_search',\n}\n\nexport type SearchEvent = {\n  id: AnalyticsEventId.SEARCH\n  payload: {\n    page_number: number\n  }\n}\n\n/**\n * Should be called whenever a new search is started.\n */\nexport const searchEvent = (page_number: number): SearchEvent => ({\n  id: AnalyticsEventId.SEARCH,\n  payload: {\n    page_number,\n  },\n})\n","import { AppAction, SET_POSTS, ADD_POSTS } from '../actions'\r\n\r\nimport { searchEvent } from '../../analytics/events'\r\nimport { selectPageNumber, selectCookies } from '../selectors'\r\nimport { MiddlewareAPI, Dispatch } from 'redux'\r\nimport { logEvent } from '../../firebase'\r\n\r\nconst eventLogging = (store: MiddlewareAPI<any>) => (next: Dispatch<AppAction>) => (action: AppAction) => {\r\n  const state = store.getState()\r\n  const cookies = selectCookies(state)\r\n\r\n  // Only send analytics if the user consented\r\n  if (cookies) {\r\n    if (action.type === ADD_POSTS || action.type === SET_POSTS) {\r\n      const pageNumber = selectPageNumber(state)\r\n      logEvent(searchEvent(pageNumber))\r\n    }\r\n  }\r\n\r\n  next(action)\r\n}\r\n\r\nexport default eventLogging\r\n","import produce from 'immer'\r\nimport * as r34 from 'r34-types'\r\nimport { AppAction, SET_PREFERENCE, SET_PREFERENCES } from '../actions'\r\n\r\nexport interface PreferencesState {\r\n  rated: boolean\r\n  ratedThreshold: number\r\n  originals: boolean\r\n  cookies: boolean\r\n  preloadVideos: boolean\r\n  tagSuggestionsCount: number\r\n  resultsLayout: r34.ResultsLayout\r\n  pageSize: number\r\n  showMetadata: boolean\r\n  showComments: boolean\r\n  sort: r34.PostsSort\r\n  themeId: r34.ThemeId\r\n  autoPlay: boolean\r\n  hideSeen: boolean\r\n  autoscrollDelay: number\r\n}\r\n\r\nexport const initialPreferencesState: PreferencesState = {\r\n  rated: false,\r\n  ratedThreshold: 1,\r\n  originals: false,\r\n  cookies: false,\r\n  preloadVideos: false,\r\n  tagSuggestionsCount: 20,\r\n  resultsLayout: 'infinite_column',\r\n  pageSize: 20,\r\n  showMetadata: false,\r\n  showComments: false,\r\n  sort: 'date',\r\n  themeId: 'dark',\r\n  autoPlay: false,\r\n  hideSeen: false,\r\n  autoscrollDelay: 10,\r\n}\r\n\r\nfunction setPreference<T extends r34.PreferenceKey>(state: PreferencesState, key: T, value: PreferencesState[T]) {\r\n  return produce(state, (draft) => {\r\n    draft[key] = value\r\n  })\r\n}\r\n\r\nfunction setPreferences(state: PreferencesState, preferences: Partial<PreferencesState>) {\r\n  return produce(state, (draft) => {\r\n    Object.assign(draft, preferences)\r\n  })\r\n}\r\n\r\nconst preferences = (state: PreferencesState = initialPreferencesState, action: AppAction): PreferencesState => {\r\n  switch (action.type) {\r\n    case SET_PREFERENCE:\r\n      return setPreference(state, action.key, action.value)\r\n    case SET_PREFERENCES:\r\n      return setPreferences(state, action.preferences)\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default preferences\r\n","import { MiddlewareAPI } from 'redux'\r\nimport { Dispatch } from 'react'\r\nimport {\r\n  AppAction,\r\n  FETCH_PREFERENCES,\r\n  savePreferences,\r\n  SAVE_PREFERENCES,\r\n  setPreferences,\r\n  SET_PREFERENCE,\r\n} from '../actions'\r\nimport * as firebaseFunctions from '../../firebase'\r\nimport { initialPreferencesState } from '../reducers/preferences'\r\n\r\nlet saveTimeout: ReturnType<typeof setTimeout> | null = null\r\n\r\nconst persistence = (store: MiddlewareAPI) => (next: Dispatch<AppAction>) => async (action: AppAction) => {\r\n  if (action.type === SET_PREFERENCE) {\r\n    if (saveTimeout) {\r\n      clearTimeout(saveTimeout)\r\n      saveTimeout = null\r\n    } else {\r\n      saveTimeout = setTimeout(() => {\r\n        store.dispatch(savePreferences())\r\n        saveTimeout = null\r\n      }, 10000)\r\n    }\r\n  }\r\n\r\n  if (action.type === FETCH_PREFERENCES) {\r\n    const preferences = await firebaseFunctions.getPreferences()\r\n\r\n    if (preferences) {\r\n      // fill gaps with default values to avoid invalid preferences\r\n      const newPreferences = { ...initialPreferencesState, ...preferences }\r\n      store.dispatch(setPreferences(newPreferences))\r\n    }\r\n  }\r\n\r\n  if (action.type === SAVE_PREFERENCES) {\r\n    const { preferences } = store.getState()\r\n    firebaseFunctions.setPreferences(preferences)\r\n  }\r\n\r\n  next(action)\r\n}\r\n\r\nexport default persistence\r\n","import firebase from 'firebase/app'\r\nimport 'firebase/auth'\r\nimport { getSupertags } from '../firebase'\r\nimport * as r34 from 'r34-types'\r\nimport { getTagParameter, isSuggestionError } from '../data/tagUtils'\r\nimport { SuggestionsError } from '../data/types'\r\n\r\ntype Version = 'v1' | 'v2'\r\ntype Target = 'local' | 'live'\r\n\r\nconst sourceTags: r34.Tag[] = [\r\n  { name: 'source:*patreon*', count: 12711, types: ['source'] },\r\n  { name: 'source:*twitter*', count: 99927, types: ['source'] },\r\n  { name: 'source:*pixiv*', count: 185080, types: ['source'] },\r\n]\r\n\r\nconst ratingTags: r34.Tag[] = [\r\n  { name: 'rating:safe', count: 14293, types: ['rating'] },\r\n  { name: 'rating:questionable', count: 219552, types: ['rating'] },\r\n  { name: 'rating:explicit', count: 3821144, types: ['rating'] },\r\n]\r\n\r\nclass API {\r\n  readonly defaultPageSize = 20\r\n  readonly apiLocal = 'http://localhost:8080'\r\n  readonly apiUrl1 = 'https://r34-json.herokuapp.com'\r\n  readonly apiUrl2 = 'https://r34-api-clone.herokuapp.com'\r\n\r\n  private target: Target = 'live'\r\n  private version: Version = 'v2'\r\n  private activeApi!: string\r\n\r\n  constructor() {\r\n    this.setActiveApi()\r\n  }\r\n\r\n  /**\r\n   * Switches between remote prod api and local dev api\r\n   */\r\n  setTarget(target: 'live' | 'local') {\r\n    this.target = target\r\n    this.setActiveApi()\r\n  }\r\n\r\n  /**\r\n   * Sets the api version to use.\r\n   */\r\n  setVersion(version: 'v1' | 'v2') {\r\n    this.version = version\r\n    this.setActiveApi()\r\n  }\r\n\r\n  /**\r\n   * Updates the base url with new configuration.\r\n   */\r\n  setActiveApi() {\r\n    if (this.target === 'local') {\r\n      this.activeApi = `${this.apiLocal}/${this.version}`\r\n    } else {\r\n      this.activeApi = `${this.apiUrl1}/${this.version}`\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Retrieves tags given a searchTerm\r\n   */\r\n  private async fetchTags(searchTerm: string, limit: number): Promise<r34.Tag[] | SuggestionsError> {\r\n    return await (await fetch(`${this.activeApi}/tags?limit=${limit}&name=${searchTerm}&sort=count`)).json()\r\n  }\r\n\r\n  async getTags(searchTerm: string, limit: number = this.defaultPageSize, includeSupertags = false) {\r\n    const doFuzzySearch = searchTerm.length > 3\r\n    try {\r\n      const result = await this.fetchTags(doFuzzySearch ? `*${searchTerm}*` : searchTerm, limit)\r\n\r\n      if (isSuggestionError(result)) {\r\n        return result\r\n      }\r\n\r\n      let tags = result as r34.AnyTag[]\r\n\r\n      if (includeSupertags) {\r\n        try {\r\n          const supertags = await getSupertags()\r\n          if (supertags) {\r\n            const matchingSupertags = Object.entries(supertags)\r\n              .filter(([name, details]) => name.toLowerCase().includes(searchTerm.toLowerCase()))\r\n              .map(([name, details]) => ({\r\n                name,\r\n                ...details,\r\n              }))\r\n            tags = [...matchingSupertags, ...tags]\r\n          }\r\n        } catch {\r\n          // do nothing as supertags are only for registered users.\r\n        }\r\n      }\r\n\r\n      // HACKY: Inject suggestions for ratings and some sources\r\n      const matchingRating = ratingTags.filter((tag) => tag.name.includes(searchTerm.replace('rating:', '')))\r\n      tags = [...matchingRating, ...tags]\r\n\r\n      const matchingSourceTags = sourceTags.filter((tag) => tag.name.includes(searchTerm.replace('source:', '')))\r\n      tags = [...matchingSourceTags, ...tags]\r\n\r\n      return tags\r\n    } catch (err) {\r\n      console.warn('Failed to get tags:', err)\r\n      return []\r\n    }\r\n  }\r\n\r\n  /**\r\n   * This function can be used to retrieve a number of posts from the backend.\r\n   */\r\n  async getPosts(\r\n    tags: Record<string, r34.AnyBiasedTag>,\r\n    limit: number = this.defaultPageSize,\r\n    pageNumber = 0,\r\n    minScore = 0,\r\n    sort: r34.PostsSort = 'date',\r\n    hideSeen = false\r\n  ) {\r\n    try {\r\n      const idToken = await firebase.auth().currentUser?.getIdToken()\r\n      const url = this.buildPostUrl(pageNumber, tags, { minScore, limit, sort, hideSeen })\r\n      const apiResponse = await fetch(url, {\r\n        headers: {\r\n          Authorization: 'Bearer ' + idToken,\r\n        },\r\n      })\r\n      const data: r34.PostsResponse = await apiResponse.json()\r\n\r\n      return data\r\n    } catch (err) {\r\n      console.warn('Failed to get posts:', err)\r\n      return { count: 0, posts: [] }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Returns all aliases for a given tag\r\n   */\r\n  async getAliases(tagName: string) {\r\n    try {\r\n      const aliases: r34.AliasTag[] = await (\r\n        await fetch(`${this.activeApi}/alias/${encodeURIComponent(tagName)}`)\r\n      ).json()\r\n\r\n      return aliases\r\n    } catch (err) {\r\n      console.warn('Failed to get aliases:', err)\r\n      return []\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Returns all comments for a given post.\r\n   */\r\n  async getComments(post: r34.Post) {\r\n    try {\r\n      const comments: r34.Comment[] = await (await fetch(post.comments_url)).json()\r\n\r\n      return comments\r\n    } catch (err) {\r\n      console.warn('Failed to get comments:', err)\r\n      return []\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Constructs an api url that will return posts that match your parameters\r\n   */\r\n  buildPostUrl(\r\n    page: number,\r\n    tags: Record<string, r34.QueryTag | r34.Supertag>,\r\n    options: {\r\n      minScore?: number\r\n      limit?: number\r\n      sort?: r34.PostsSort\r\n      hideSeen?: boolean\r\n    } = {}\r\n  ) {\r\n    const { minScore = 0, limit = api.defaultPageSize, sort = 'date', hideSeen = false } = options\r\n    const params = {\r\n      pid: page,\r\n      limit,\r\n      hideSeen,\r\n      tags: getTagParameter(tags, minScore, sort),\r\n    }\r\n\r\n    return `${api.activeApi}/posts?${Object.entries(params)\r\n      .map(([key, value]) => (value === '' || value === false ? null : `${key}=${value}`))\r\n      .filter((i) => i !== null)\r\n      .join('&')}`\r\n  }\r\n}\r\n\r\nexport const api = new API()\r\n","import { AliasTag } from 'r34-types'\r\nimport { Dispatch } from 'react'\r\nimport { MiddlewareAPI } from 'redux'\r\nimport { isSuggestionError, isSupertag, serializeTagname } from '../../data/tagUtils'\r\nimport { api } from '../../misc/api'\r\nimport {\r\n  addAliases,\r\n  addPosts,\r\n  ADD_TAG,\r\n  AppAction,\r\n  FETCH_COMMENTS,\r\n  FETCH_SUGGESTIONS,\r\n  GET_MORE_RESULTS,\r\n  GET_RESULTS,\r\n  LIKE_POST,\r\n  setComments,\r\n  setPosts,\r\n  setSuggestions,\r\n  setSuggestionsError,\r\n} from '../actions'\r\nimport {\r\n  selectActiveTags,\r\n  selectHasMoreResults,\r\n  selectHideSeen,\r\n  selectMinRating,\r\n  selectPageNumber,\r\n  selectPageSize,\r\n  selectPostById,\r\n  selectSort,\r\n  selectTagSuggestionCount,\r\n} from '../selectors'\r\n\r\nconst apiRequests = (store: MiddlewareAPI) => (next: Dispatch<AppAction>) => async (action: AppAction) => {\r\n  const state = store.getState()\r\n  const hasMoreResults = selectHasMoreResults(state)\r\n\r\n  if (action.type === GET_RESULTS) {\r\n    const activeTags = selectActiveTags(state)\r\n    const pageSize = selectPageSize(state)\r\n    const minRating = selectMinRating(state)\r\n    const sort = selectSort(state)\r\n    const hideSeen = selectHideSeen(state)\r\n\r\n    const result = await api.getPosts(activeTags, pageSize, action.pageNumber, minRating, sort, hideSeen)\r\n\r\n    store.dispatch(setPosts(result.posts, result.count, action.pageNumber))\r\n  }\r\n\r\n  if (action.type === GET_MORE_RESULTS && hasMoreResults) {\r\n    const activeTags = selectActiveTags(state)\r\n    const pageNumber = selectPageNumber(state)\r\n    const pageSize = selectPageSize(state)\r\n    const minRating = selectMinRating(state)\r\n    const sort = selectSort(state)\r\n    const hideSeen = selectHideSeen(state)\r\n\r\n    const res = await api.getPosts(activeTags, pageSize, pageNumber + 1, minRating, sort, hideSeen)\r\n\r\n    store.dispatch(addPosts(res.posts))\r\n  }\r\n\r\n  if (action.type === ADD_TAG) {\r\n    const activeTags = selectActiveTags(state)\r\n    let aliases: AliasTag[] = []\r\n    try {\r\n      aliases = await api.getAliases(action.tag.name)\r\n    } catch (err) {\r\n      console.warn('Failed toget aliases for tag:', action.tag)\r\n    }\r\n\r\n    const sanitizedAliases = aliases\r\n      .sort((a, b) => b.count - a.count)\r\n      .filter((alias) => !(alias.name in activeTags))\r\n      .map(({ name, count }) => ({ name, count, types: [] }))\r\n\r\n    store.dispatch(addAliases(sanitizedAliases, action.tag.name))\r\n\r\n    // Request types for newly added tag\r\n    if (!isSupertag(action.tag) && action.tag.types.length === 0) {\r\n      try {\r\n        const data = await api.getTags(action.tag.name, 1, false)\r\n        if (!isSuggestionError(data)) {\r\n          const tag = data.find((tag) => tag.name === action.tag.name)\r\n\r\n          if (tag && !isSupertag(tag)) {\r\n            action.tag.types = tag.types\r\n            action.tag.count = tag.count\r\n          }\r\n        }\r\n      } catch (err) {\r\n        console.warn('Failed to get types for tag:', action.tag)\r\n      }\r\n    }\r\n  }\r\n\r\n  if (action.type === LIKE_POST) {\r\n    fetch(`https://rule34.xxx/index.php?page=post&s=vote&id=${action.postId}&type=up`, { mode: 'no-cors' })\r\n      .then(() => {\r\n        // nothing to do, I update the state in advance\r\n      })\r\n      .catch((err) => {\r\n        console.warn('Upvote rejected', err)\r\n      })\r\n  }\r\n\r\n  if (action.type === FETCH_SUGGESTIONS) {\r\n    const limit = selectTagSuggestionCount(state)\r\n    const result = await api.getTags(serializeTagname(action.value), limit, action.includeSupertags)\r\n\r\n    if (isSuggestionError(result)) {\r\n      store.dispatch(setSuggestionsError(result))\r\n    } else {\r\n      store.dispatch(setSuggestions(result))\r\n    }\r\n  }\r\n\r\n  if (action.type === FETCH_COMMENTS) {\r\n    const post = selectPostById(action.postId)(state)\r\n\r\n    if (post) {\r\n      const comments = await api.getComments(post)\r\n      store.dispatch(setComments(action.postId, comments))\r\n    }\r\n  }\r\n\r\n  next(action)\r\n}\r\n\r\nexport default apiRequests\r\n","import { applyMiddleware } from 'redux'\r\nimport analytics from './analytics'\r\nimport persistence from './persistence'\r\nimport requests from './requests'\r\nimport { composeWithDevTools } from 'redux-devtools-extension'\r\n\r\nconst middleware = composeWithDevTools(applyMiddleware(analytics, requests, persistence))\r\n\r\nexport default middleware\r\n","export const migrations = {\r\n  // Delete reader state\r\n  278: (state: any) => {\r\n    return {\r\n      ...state,\r\n      reader: undefined,\r\n    }\r\n  },\r\n  // Add autoscroll delay\r\n  279: (state: any) => {\r\n    return {\r\n      ...state,\r\n      preferences: {\r\n        ...state.preferences,\r\n        autoscrollDelay: 10,\r\n      },\r\n    }\r\n  },\r\n  // Removed electric theme\r\n  285: (state: any) => {\r\n    if (state.preferences.themeId === 'electric') {\r\n      return {\r\n        ...state,\r\n        preferences: {\r\n          ...state.preferences,\r\n          themeId: 'deepsea',\r\n        },\r\n      }\r\n    } else {\r\n      return state\r\n    }\r\n  },\r\n}\r\n","import produce from 'immer'\r\nimport { Comment, Post } from 'r34-types'\r\nimport { SET_POSTS, ADD_POSTS, SET_COMMENTS, AppAction } from '../actions'\r\n\r\nexport interface ResultsState {\r\n  posts: Post[]\r\n  pageNumber: number\r\n  count: number\r\n  updated: number\r\n}\r\n\r\nconst initialResultsState: ResultsState = {\r\n  posts: [],\r\n  pageNumber: 0,\r\n  count: 0,\r\n  updated: 0,\r\n}\r\n\r\nconst addPosts = (state: ResultsState, posts: Post[]) =>\r\n  produce(state, (draft) => {\r\n    draft.posts = [...state.posts, ...posts]\r\n    draft.pageNumber = state.pageNumber + 1\r\n    draft.updated = new Date().getTime()\r\n  })\r\n\r\nconst setPosts = (state: ResultsState, posts: Post[], postCount: number, pageNumber: number = 0) =>\r\n  produce(state, (draft) => {\r\n    draft.posts = posts\r\n    draft.count = postCount\r\n    draft.pageNumber = pageNumber\r\n    draft.updated = new Date().getTime()\r\n  })\r\n\r\nconst setComments = (state: ResultsState, postId: number, comments: Comment[]) =>\r\n  produce(state, (draft) => {\r\n    const postIndex = state.posts.findIndex((p) => p.id === postId)\r\n    if (postIndex >= 0) {\r\n      draft.posts[postIndex].comments = comments\r\n    }\r\n  })\r\n\r\nconst results = (state: ResultsState = initialResultsState, action: AppAction): ResultsState => {\r\n  switch (action.type) {\r\n    case ADD_POSTS:\r\n      return addPosts(state, action.posts)\r\n    case SET_POSTS:\r\n      return setPosts(state, action.posts, action.count, action.pageNumber)\r\n    case SET_COMMENTS:\r\n      return setComments(state, action.postId, action.comments)\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default results\r\n","import produce from 'immer'\r\nimport { AliasTag, AnyBiasedTag } from 'r34-types'\r\nimport { ADD_TAG, AppAction, REMOVE_TAG, ADD_ALIASES } from '../actions'\r\n\r\nexport interface TagsState {\r\n  active: Record<string, AnyBiasedTag>\r\n  aliases: Record<string, AliasTag[]>\r\n}\r\n\r\nconst initialTagsState: TagsState = {\r\n  active: {},\r\n  aliases: {},\r\n}\r\n\r\nconst addTag = (state: TagsState, newTag: AnyBiasedTag) =>\r\n  produce(state, (draft) => {\r\n    draft.active[newTag.name] = { ...state.active[newTag.name], ...newTag }\r\n  })\r\n\r\nconst addAliases = (state: TagsState, aliases: AliasTag[], forTag: string) =>\r\n  produce(state, (draft) => {\r\n    draft.aliases[forTag] = aliases\r\n  })\r\n\r\nconst removeTag = (state: TagsState, tagName: string) =>\r\n  produce(state, (draft) => {\r\n    delete draft.active[tagName]\r\n    delete draft.aliases[tagName]\r\n  })\r\n\r\nconst tags = (state: TagsState = initialTagsState, action: AppAction): TagsState => {\r\n  switch (action.type) {\r\n    case ADD_TAG:\r\n      return addTag(state, action.tag)\r\n    case REMOVE_TAG:\r\n      return removeTag(state, action.tagName)\r\n    case ADD_ALIASES:\r\n      return addAliases(state, action.aliases, action.forTag)\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default tags\r\n","import produce from 'immer'\nimport { ENTER_FULLSCREEN, EXIT_FULLSCREEN, SET_FULLSCREEN_POST, AppAction, SCROLL_TO_POST } from '../actions'\n\nexport interface FullscreenState {\n  isEnabled: boolean\n  currentIndex: number\n  scrollIndex: number | null\n}\n\nconst initialFullscreenState: FullscreenState = {\n  isEnabled: false,\n  currentIndex: 0,\n  scrollIndex: null,\n}\n\nconst enterFullscreen = (state: FullscreenState, index: number) =>\n  produce(state, (draft) => {\n    draft.isEnabled = true\n    draft.currentIndex = index\n  })\n\nconst exitFullscreen = (state: FullscreenState) =>\n  produce(state, (draft) => {\n    draft.isEnabled = false\n  })\n\nconst setIndex = (state: FullscreenState, index: number) =>\n  produce(state, (draft) => {\n    draft.currentIndex = index\n  })\n\nconst setScrollIndex = (state: FullscreenState, index: number) =>\n  produce(state, (draft) => {\n    draft.scrollIndex = index\n  })\n\nexport const fullscreen = (state: FullscreenState = initialFullscreenState, action: AppAction): FullscreenState => {\n  switch (action.type) {\n    case ENTER_FULLSCREEN:\n      return enterFullscreen(state, action.postId)\n    case SET_FULLSCREEN_POST:\n      return setIndex(state, action.index)\n    case EXIT_FULLSCREEN:\n      return exitFullscreen(state)\n    case SCROLL_TO_POST:\n      return setScrollIndex(state, action.index)\n    default:\n      return state\n  }\n}\n","import produce from 'immer'\r\nimport { AppAction, LIKE_POST } from '../actions'\r\n\r\n/**\r\n * Key is postId, Value is time of like\r\n */\r\nexport type LikesState = Record<number, number>\r\n\r\nconst initialLikesState: LikesState = {}\r\n\r\nconst likePost = (state: LikesState, postId: number) =>\r\n  produce(state, (draft) => {\r\n    if (!(postId in state)) {\r\n      draft[postId] = Date.now()\r\n    }\r\n\r\n    // NOTE: Might need to introduce a cap here...\r\n    // Like 1000 likes max, delete oldest when more are added?\r\n  })\r\n\r\nconst likes = (state: LikesState = initialLikesState, action: AppAction): LikesState => {\r\n  switch (action.type) {\r\n    case LIKE_POST:\r\n      return likePost(state, action.postId)\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default likes\r\n","import produce from 'immer'\r\nimport { ModalId } from '../../data/types'\r\nimport { AppAction, CLOSE_MODAL, OPEN_MODAL } from '../actions'\r\n\r\nexport interface ModalsState {\r\n  openModal: ModalId | null\r\n}\r\n\r\nconst initialModalsState: ModalsState = {\r\n  openModal: null,\r\n}\r\n\r\nconst setOpenModal = (state: ModalsState, modalId: ModalId | null) =>\r\n  produce(state, (draft) => {\r\n    draft.openModal = modalId\r\n  })\r\n\r\nconst modals = (state: ModalsState = initialModalsState, action: AppAction): ModalsState => {\r\n  switch (action.type) {\r\n    case OPEN_MODAL:\r\n      return setOpenModal(state, action.modalId)\r\n    case CLOSE_MODAL:\r\n      return setOpenModal(state, null)\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default modals\r\n","import produce from 'immer'\r\nimport * as r34 from 'r34-types'\r\nimport { SuggestionsError } from '../../data/types'\r\nimport { AppAction, SET_SUGGESTIONS, SET_SUGGESTIONS_ERROR, SET_SUGGESTIONS_MODIFIER } from '../actions'\r\n\r\nexport interface SuggestionsState {\r\n  entries: r34.AnyTag[]\r\n  error: SuggestionsError | null\r\n  modifier: r34.TagModifier\r\n}\r\n\r\nconst initialSuggestionsState: SuggestionsState = {\r\n  entries: [],\r\n  error: null,\r\n  modifier: '+',\r\n}\r\n\r\nconst setSuggestions = (state: SuggestionsState, suggestions: r34.AnyTag[]) =>\r\n  produce(state, (draft) => {\r\n    draft.entries = suggestions\r\n    draft.error = null\r\n  })\r\n\r\nconst setError = (state: SuggestionsState, error: SuggestionsError) =>\r\n  produce(state, (draft) => {\r\n    draft.entries = []\r\n    draft.error = error\r\n  })\r\n\r\nconst setModifier = (state: SuggestionsState, modifier: r34.TagModifier) =>\r\n  produce(state, (draft) => {\r\n    draft.modifier = modifier\r\n  })\r\n\r\nconst suggestions = (state: SuggestionsState = initialSuggestionsState, action: AppAction): SuggestionsState => {\r\n  switch (action.type) {\r\n    case SET_SUGGESTIONS:\r\n      return setSuggestions(state, action.suggestions)\r\n    case SET_SUGGESTIONS_ERROR:\r\n      return setError(state, action.error)\r\n    case SET_SUGGESTIONS_MODIFIER:\r\n      return setModifier(state, action.modifier)\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default suggestions\r\n","import { combineReducers } from 'redux'\nimport preferences from './preferences'\nimport results from './results'\nimport tags from './tags'\nimport { fullscreen } from './fullscreen'\nimport likes from './likes'\nimport modals from './modals'\nimport suggestions from './suggestions'\n\nexport default combineReducers({ tags, results, preferences, fullscreen, likes, suggestions, modals })\n","import { createStore } from 'redux'\nimport { createMigrate, persistReducer, persistStore } from 'redux-persist'\nimport storage from 'redux-persist/lib/storage'\nimport { getVersion, versionToNumber } from '../data/utils'\nimport middleware from './middleware'\nimport { migrations } from './migrations'\nimport rootReducer from './reducers'\n\nconst version = getVersion()\n\nconst persistConfig = {\n  key: 'appstate',\n  version: versionToNumber(version),\n  storage,\n  migrate: createMigrate(migrations),\n}\n\nconst persistedReducer = persistReducer(persistConfig, rootReducer)\n\nexport const store = createStore(persistedReducer, middleware)\n\nexport const persistor = persistStore(store)\n","import React, { Suspense } from 'react'\r\nimport { Helmet } from 'react-helmet'\r\nimport { Provider, useSelector } from 'react-redux'\r\nimport { HashRouter, Route, Switch } from 'react-router-dom'\r\nimport { PersistGate } from 'redux-persist/integration/react'\r\nimport { ThemeProvider } from 'styled-components'\r\nimport ErrorBoundary from './components/features/ErrorBoundary'\r\nimport GlobalKeybindings from './components/features/GlobalKeybindings'\r\nimport ErrorScreen from './components/pages/ErrorScreen'\r\nimport LoadingScreen from './components/pages/LoadingScreen'\r\nimport Terms from './components/pages/Terms'\r\nimport CellularWarningModal from './components/widgets/CellularWarningModal'\r\nimport CookieConfirmation from './components/widgets/CookieConfirmation'\r\nimport SupertagModal from './components/widgets/SupertagModal'\r\nimport { RouteName } from './data/types'\r\nimport './firebase' // init firebase immediately\r\nimport GlobalStyles from './GlobalStyles'\r\nimport { useLoadPreferences } from './hooks/useLoadPreferences'\r\nimport {\r\n  selectActiveThemeId,\r\n  selectCellularWarningModalOpen,\r\n  selectCookies,\r\n  selectSupertagModalOpen,\r\n} from './redux/selectors'\r\nimport { persistor, store } from './redux/store'\r\nimport { themes, defaultThemeId } from 'r34-branding'\r\n\r\nconst About = React.lazy(() => import('./components/pages/About'))\r\nconst Privacy = React.lazy(() => import('./components/pages/Privacy'))\r\nconst Search = React.lazy(() => import('./components/pages/Search'))\r\nconst Preferences = React.lazy(() => import('./components/pages/Preferences'))\r\nconst Share = React.lazy(() => import('./components/pages/Share'))\r\nconst Stories = React.lazy(() => import('./components/pages/Stories'))\r\n\r\nconst loadingScreen = <LoadingScreen />\r\n\r\nexport default function App() {\r\n  return (\r\n    <ErrorBoundary fallback={<ErrorScreen />}>\r\n      <Provider store={store}>\r\n        <PersistGate loading={loadingScreen} persistor={persistor}>\r\n          <ThemedApp />\r\n        </PersistGate>\r\n      </Provider>\r\n    </ErrorBoundary>\r\n  )\r\n}\r\n\r\nfunction ThemedApp() {\r\n  const cookies = useSelector(selectCookies)\r\n  const isCellularWarningModalOpen = useSelector(selectCellularWarningModalOpen)\r\n  const isSupertagModalOpen = useSelector(selectSupertagModalOpen)\r\n  const themeId = useSelector(selectActiveThemeId)\r\n  const theme = themes[themeId] || defaultThemeId\r\n\r\n  useLoadPreferences()\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <GlobalStyles />\r\n      <GlobalKeybindings />\r\n      <Helmet>\r\n        <meta name='theme-color' content={theme.colors.layerBgSolid} />\r\n      </Helmet>\r\n      <HashRouter>\r\n        <Suspense fallback={loadingScreen}>\r\n          <Switch>\r\n            <Route exact path={RouteName.ABOUT} component={About} />\r\n            <Route exact path={RouteName.PRIVACY} component={Privacy} />\r\n            <Route exact path={RouteName.PREFERENCES} component={Preferences} />\r\n            <Route exact path={RouteName.STORIES} component={Stories} />\r\n            <Route exact path={RouteName.TERMS} component={Terms} />\r\n            <Route exact path={RouteName.SHARE} component={Share} />\r\n            <Route path={RouteName.SEARCH} component={Search} />\r\n          </Switch>\r\n        </Suspense>\r\n\r\n        {isSupertagModalOpen && <SupertagModal />}\r\n        {isCellularWarningModalOpen && <CellularWarningModal />}\r\n        {!cookies && <CookieConfirmation />}\r\n      </HashRouter>\r\n    </ThemeProvider>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { useDispatch } from 'react-redux'\r\nimport { fetchPreferences } from '../redux/actions'\r\nimport useFirebaseAuthState from './useFirebaseAuthState'\r\n\r\nexport function useLoadPreferences() {\r\n  const dispatch = useDispatch()\r\n  const [isSignedIn] = useFirebaseAuthState()\r\n\r\n  React.useEffect(() => {\r\n    if (isSignedIn) {\r\n      dispatch(fetchPreferences())\r\n    }\r\n  }, [dispatch, isSignedIn])\r\n}\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n)\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void\n  onUpdate?: (registration: ServiceWorkerRegistration) => void\n}\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://cra.link/PWA'\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://cra.link/PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (response.status === 404 || (contentType != null && contentType.indexOf('javascript') === -1)) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.')\n    })\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister()\n      })\n      .catch((error) => {\n        console.error(error.message)\n      })\n  }\n}\n","// Polyfills\nimport 'whatwg-fetch'\n\nimport * as Sentry from '@sentry/react'\nimport { Offline } from '@sentry/integrations'\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport { getVersionString } from './data/utils'\nimport * as serviceWorkerRegistration from './serviceWorkerRegistration'\n\nSentry.init({\n  dsn: 'https://1a2933d829da41fe84d4dab5fcc520ae@o955708.ingest.sentry.io/5905045',\n  integrations: [new Offline()],\n  tracesSampleRate: 1.0,\n  release: getVersionString(),\n  beforeBreadcrumb(breadcrumb, hint) {\n    try {\n      if (breadcrumb?.category?.startsWith('ui')) {\n        const target = hint?.event.target as HTMLElement\n        const tag = target.tagName.toLowerCase()\n        if (target.innerText) {\n          breadcrumb.message = `${tag}: ${target.innerText}`\n        } else if (target.id) {\n          breadcrumb.message = `${tag}: ${target.id}`\n        } else if (target.getAttribute('name')) {\n          breadcrumb.message = `${tag}: ${target.getAttribute('name')}`\n        } else if (target.title) {\n          breadcrumb.message = `${tag}: ${target.title}`\n        } else if (target.getAttribute('aria-label')) {\n          breadcrumb.message = `${tag}: ${target.getAttribute('aria-label')}`\n        } else if (target.getAttribute('data-name')) {\n          breadcrumb.message = `${tag}: ${target.getAttribute('data-name')}`\n        }\n      }\n    } catch (err) {\n      // fancy breadcrumbs are optional. So no error handling required.\n    }\n    return breadcrumb\n  },\n})\n\nReactDOM.render(\n  // <React.StrictMode>\n  <App />,\n  // </React.StrictMode>\n  document.getElementById('app-root')\n)\n\nserviceWorkerRegistration.register()\n"],"sourceRoot":""}